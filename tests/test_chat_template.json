{
  "Qwen/Qwen2.5-3B-Instruct": {
    "template": "{%- if tools %}\n    {{- '<|im_start|>system\\n' }}\n    {%- if messages[0]['role'] == 'system' %}\n        {{- messages[0]['content'] }}\n    {%- else %}\n        {{- 'You are Qwen, created by Alibaba Cloud. You are a helpful assistant.' }}\n    {%- endif %}\n    {{- \"\\n\\n# Tools\\n\\nYou may call one or more functions to assist with the user query.\\n\\nYou are provided with function signatures within <tools></tools> XML tags:\\n<tools>\" }}\n    {%- for tool in tools %}\n        {{- \"\\n\" }}\n        {{- tool | tojson }}\n    {%- endfor %}\n    {{- \"\\n</tools>\\n\\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\\n<tool_call>\\n{\\\"name\\\": <function-name>, \\\"arguments\\\": <args-json-object>}\\n</tool_call><|im_end|>\\n\" }}\n{%- else %}\n    {%- if messages[0]['role'] == 'system' %}\n        {{- '<|im_start|>system\\n' + messages[0]['content'] + '<|im_end|>\\n' }}\n    {%- else %}\n        {{- '<|im_start|>system\\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.<|im_end|>\\n' }}\n    {%- endif %}\n{%- endif %}\n{%- for message in messages %}\n    {%- if (message.role == \"user\") or (message.role == \"system\" and not loop.first) or (message.role == \"assistant\" and not message.tool_calls) %}\n        {{- '<|im_start|>' + message.role + '\\n' + message.content + '<|im_end|>' + '\\n' }}\n    {%- elif message.role == \"assistant\" %}\n        {{- '<|im_start|>' + message.role }}\n        {%- if message.content %}\n            {{- '\\n' + message.content }}\n        {%- endif %}\n        {%- for tool_call in message.tool_calls %}\n            {%- if tool_call.function is defined %}\n                {%- set tool_call = tool_call.function %}\n            {%- endif %}\n            {{- '\\n<tool_call>\\n{\"name\": \"' }}\n            {{- tool_call.name }}\n            {{- '\", \"arguments\": ' }}\n            {{- tool_call.arguments | tojson }}\n            {{- '}\\n</tool_call>' }}\n        {%- endfor %}\n        {{- '<|im_end|>\\n' }}\n    {%- elif message.role == \"tool\" %}\n        {%- if (loop.index0 == 0) or (messages[loop.index0 - 1].role != \"tool\") %}\n            {{- '<|im_start|>user' }}\n        {%- endif %}\n        {{- '\\n<tool_response>\\n' }}\n        {{- message.content }}\n        {{- '\\n</tool_response>' }}\n        {%- if loop.last or (messages[loop.index0 + 1].role != \"tool\") %}\n            {{- '<|im_end|>\\n' }}\n        {%- endif %}\n    {%- endif %}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|im_start|>assistant\\n' }}\n{%- endif %}\n",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.<|im_end|>\n<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.<|im_end|>\n<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"NY\\\"}\"}\n</tool_call><|im_end|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"NY\\\"}\"}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n{\"temp\": 20}\n</tool_response><|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "parallel_tool_calls",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY and SF?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_1",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              },
              {
                "id": "call_2",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"SF\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_1",
            "name": "get_weather",
            "content": "20C"
          },
          {
            "role": "tool",
            "tool_call_id": "call_2",
            "name": "get_weather",
            "content": "15C"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY and SF?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"NY\\\"}\"}\n</tool_call>\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"SF\\\"}\"}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n20C\n</tool_response>\n<tool_response>\n15C\n</tool_response><|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.<|im_end|>\n<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "Qwen/Qwen2.5-VL-3B-Instruct": {
    "template": "{% set image_count = namespace(value=0) %}{% set video_count = namespace(value=0) %}{% for message in messages %}{% if loop.first and message['role'] != 'system' %}<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n{% endif %}<|im_start|>{{ message['role'] }}\n{% if message['content'] is string %}{{ message['content'] }}<|im_end|>\n{% else %}{% for content in message['content'] %}{% if content['type'] == 'image' or 'image' in content or 'image_url' in content %}{% set image_count.value = image_count.value + 1 %}{% if add_vision_id %}Picture {{ image_count.value }}: {% endif %}<|vision_start|><|image_pad|><|vision_end|>{% elif content['type'] == 'video' or 'video' in content %}{% set video_count.value = video_count.value + 1 %}{% if add_vision_id %}Video {{ video_count.value }}: {% endif %}<|vision_start|><|video_pad|><|vision_end|>{% elif 'text' in content %}{{ content['text'] }}{% endif %}{% endfor %}<|im_end|>\n{% endif %}{% endfor %}{% if add_generation_prompt %}<|im_start|>assistant\n{% endif %}",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<|im_end|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<|im_end|>\n<|im_start|>tool\n{\"temp\": 20}<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "parallel_tool_calls",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY and SF?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_1",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              },
              {
                "id": "call_2",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"SF\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_1",
            "name": "get_weather",
            "content": "20C"
          },
          {
            "role": "tool",
            "tool_call_id": "call_2",
            "name": "get_weather",
            "content": "15C"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nWeather in NY and SF?<|im_end|>\n<|im_start|>assistant\n<|im_end|>\n<|im_start|>tool\n20C<|im_end|>\n<|im_start|>tool\n15C<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "Qwen/Qwen2.5-Omni-3B": {
    "template": "{% set audio_count = namespace(value=0) %}{% set image_count = namespace(value=0) %}{% set video_count = namespace(value=0) %}{% for message in messages %}{% if loop.first and message['role'] != 'system' %}<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n{% endif %}<|im_start|>{{ message['role'] }}\n{% if message['content'] is string %}{{ message['content'] }}<|im_end|>\n{% else %}{% for content in message['content'] %}{% if content['type'] == 'image' or 'image' in content or 'image_url' in content %}{% set image_count.value = image_count.value + 1 %}{% if add_vision_id %}Picture {{ image_count.value }}: {% endif %}<|vision_bos|><|IMAGE|><|vision_eos|>{% elif content['type'] == 'audio' or 'audio' in content or 'audio_url' in content %}{% set audio_count.value = audio_count.value + 1 %}{% if add_audio_id %}Audio {{ audio_count.value }}: {% endif %}<|audio_bos|><|AUDIO|><|audio_eos|>{% elif content['type'] == 'video' or 'video' in content %}{% set video_count.value = video_count.value + 1 %}{% if add_vision_id %}Video {{ video_count.value }}: {% endif %}<|vision_bos|><|VIDEO|><|vision_eos|>{% elif 'text' in content %}{{ content['text'] }}{% endif %}{% endfor %}<|im_end|>\n{% endif %}{% endfor %}{% if add_generation_prompt %}<|im_start|>assistant\n{% endif %}",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<|im_end|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<|im_end|>\n<|im_start|>tool\n{\"temp\": 20}<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "parallel_tool_calls",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY and SF?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_1",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              },
              {
                "id": "call_2",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"SF\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_1",
            "name": "get_weather",
            "content": "20C"
          },
          {
            "role": "tool",
            "tool_call_id": "call_2",
            "name": "get_weather",
            "content": "15C"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nWeather in NY and SF?<|im_end|>\n<|im_start|>assistant\n<|im_end|>\n<|im_start|>tool\n20C<|im_end|>\n<|im_start|>tool\n15C<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "Qwen/Qwen2.5-7B-Instruct-1M": {
    "template": "{%- if tools %}\n    {{- '<|im_start|>system\\n' }}\n    {%- if messages[0]['role'] == 'system' %}\n        {{- messages[0]['content'] }}\n    {%- else %}\n        {{- 'You are a helpful assistant.' }}\n    {%- endif %}\n    {{- \"\\n\\n# Tools\\n\\nYou may call one or more functions to assist with the user query.\\n\\nYou are provided with function signatures within <tools></tools> XML tags:\\n<tools>\" }}\n    {%- for tool in tools %}\n        {{- \"\\n\" }}\n        {{- tool | tojson }}\n    {%- endfor %}\n    {{- \"\\n</tools>\\n\\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\\n<tool_call>\\n{\\\"name\\\": <function-name>, \\\"arguments\\\": <args-json-object>}\\n</tool_call><|im_end|>\\n\" }}\n{%- else %}\n    {%- if messages[0]['role'] == 'system' %}\n        {{- '<|im_start|>system\\n' + messages[0]['content'] + '<|im_end|>\\n' }}\n    {%- else %}\n        {{- '<|im_start|>system\\nYou are a helpful assistant.<|im_end|>\\n' }}\n    {%- endif %}\n{%- endif %}\n{%- for message in messages %}\n    {%- if (message.role == \"user\") or (message.role == \"system\" and not loop.first) or (message.role == \"assistant\" and not message.tool_calls) %}\n        {{- '<|im_start|>' + message.role + '\\n' + message.content + '<|im_end|>' + '\\n' }}\n    {%- elif message.role == \"assistant\" %}\n        {{- '<|im_start|>' + message.role }}\n        {%- if message.content %}\n            {{- '\\n' + message.content }}\n        {%- endif %}\n        {%- for tool_call in message.tool_calls %}\n            {%- if tool_call.function is defined %}\n                {%- set tool_call = tool_call.function %}\n            {%- endif %}\n            {{- '\\n<tool_call>\\n{\"name\": \"' }}\n            {{- tool_call.name }}\n            {{- '\", \"arguments\": ' }}\n            {{- tool_call.arguments | tojson }}\n            {{- '}\\n</tool_call>' }}\n        {%- endfor %}\n        {{- '<|im_end|>\\n' }}\n    {%- elif message.role == \"tool\" %}\n        {%- if (loop.index0 == 0) or (messages[loop.index0 - 1].role != \"tool\") %}\n            {{- '<|im_start|>user' }}\n        {%- endif %}\n        {{- '\\n<tool_response>\\n' }}\n        {{- message.content }}\n        {{- '\\n</tool_response>' }}\n        {%- if loop.last or (messages[loop.index0 + 1].role != \"tool\") %}\n            {{- '<|im_end|>\\n' }}\n        {%- endif %}\n    {%- endif %}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|im_start|>assistant\\n' }}\n{%- endif %}\n",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"NY\\\"}\"}\n</tool_call><|im_end|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"NY\\\"}\"}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n{\"temp\": 20}\n</tool_response><|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "parallel_tool_calls",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY and SF?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_1",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              },
              {
                "id": "call_2",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"SF\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_1",
            "name": "get_weather",
            "content": "20C"
          },
          {
            "role": "tool",
            "tool_call_id": "call_2",
            "name": "get_weather",
            "content": "15C"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful assistant.\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY and SF?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"NY\\\"}\"}\n</tool_call>\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"SF\\\"}\"}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n20C\n</tool_response>\n<tool_response>\n15C\n</tool_response><|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "Qwen/Qwen2.5-Math-7B-Instruct": {
    "template": "{%- if tools %}\n    {{- '<|im_start|>system\\n' }}\n    {%- if messages[0]['role'] == 'system' %}\n        {{- messages[0]['content'] }}\n    {%- else %}\n        {{- 'Please reason step by step, and put your final answer within \\\\boxed{}.' }}\n    {%- endif %}\n    {{- \"\\n\\n# Tools\\n\\nYou may call one or more functions to assist with the user query.\\n\\nYou are provided with function signatures within <tools></tools> XML tags:\\n<tools>\" }}\n    {%- for tool in tools %}\n        {{- \"\\n\" }}\n        {{- tool | tojson }}\n    {%- endfor %}\n    {{- \"\\n</tools>\\n\\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\\n<tool_call>\\n{\\\"name\\\": <function-name>, \\\"arguments\\\": <args-json-object>}\\n</tool_call><|im_end|>\\n\" }}\n{%- else %}\n    {%- if messages[0]['role'] == 'system' %}\n        {{- '<|im_start|>system\\n' + messages[0]['content'] + '<|im_end|>\\n' }}\n    {%- else %}\n        {{- '<|im_start|>system\\nPlease reason step by step, and put your final answer within \\\\boxed{}.<|im_end|>\\n' }}\n    {%- endif %}\n{%- endif %}\n{%- for message in messages %}\n    {%- if (message.role == \"user\") or (message.role == \"system\" and not loop.first) or (message.role == \"assistant\" and not message.tool_calls) %}\n        {{- '<|im_start|>' + message.role + '\\n' + message.content + '<|im_end|>' + '\\n' }}\n    {%- elif message.role == \"assistant\" %}\n        {{- '<|im_start|>' + message.role }}\n        {%- if message.content %}\n            {{- '\\n' + message.content }}\n        {%- endif %}\n        {%- for tool_call in message.tool_calls %}\n            {%- if tool_call.function is defined %}\n                {%- set tool_call = tool_call.function %}\n            {%- endif %}\n            {{- '\\n<tool_call>\\n{\"name\": \"' }}\n            {{- tool_call.name }}\n            {{- '\", \"arguments\": ' }}\n            {{- tool_call.arguments | tojson }}\n            {{- '}\\n</tool_call>' }}\n        {%- endfor %}\n        {{- '<|im_end|>\\n' }}\n    {%- elif message.role == \"tool\" %}\n        {%- if (loop.index0 == 0) or (messages[loop.index0 - 1].role != \"tool\") %}\n            {{- '<|im_start|>user' }}\n        {%- endif %}\n        {{- '\\n<tool_response>\\n' }}\n        {{- message.content }}\n        {{- '\\n</tool_response>' }}\n        {%- if loop.last or (messages[loop.index0 + 1].role != \"tool\") %}\n            {{- '<|im_end|>\\n' }}\n        {%- endif %}\n    {%- endif %}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|im_start|>assistant\\n' }}\n{%- endif %}\n",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nPlease reason step by step, and put your final answer within \\boxed{}.<|im_end|>\n<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nPlease reason step by step, and put your final answer within \\boxed{}.<|im_end|>\n<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nPlease reason step by step, and put your final answer within \\boxed{}.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nPlease reason step by step, and put your final answer within \\boxed{}.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nPlease reason step by step, and put your final answer within \\boxed{}.<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nPlease reason step by step, and put your final answer within \\boxed{}.\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nPlease reason step by step, and put your final answer within \\boxed{}.\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"NY\\\"}\"}\n</tool_call><|im_end|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nPlease reason step by step, and put your final answer within \\boxed{}.\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"NY\\\"}\"}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n{\"temp\": 20}\n</tool_response><|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "parallel_tool_calls",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY and SF?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_1",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              },
              {
                "id": "call_2",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"SF\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_1",
            "name": "get_weather",
            "content": "20C"
          },
          {
            "role": "tool",
            "tool_call_id": "call_2",
            "name": "get_weather",
            "content": "15C"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nPlease reason step by step, and put your final answer within \\boxed{}.\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY and SF?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"NY\\\"}\"}\n</tool_call>\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"SF\\\"}\"}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n20C\n</tool_response>\n<tool_response>\n15C\n</tool_response><|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nPlease reason step by step, and put your final answer within \\boxed{}.<|im_end|>\n<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "Qwen/QwQ-32B": {
    "template": "{%- if tools %}\n    {{- '<|im_start|>system\\n' }}\n    {%- if messages[0]['role'] == 'system' %}\n        {{- messages[0]['content'] }}\n    {%- else %}\n        {{- '' }}\n    {%- endif %}\n    {{- \"\\n\\n# Tools\\n\\nYou may call one or more functions to assist with the user query.\\n\\nYou are provided with function signatures within <tools></tools> XML tags:\\n<tools>\" }}\n    {%- for tool in tools %}\n        {{- \"\\n\" }}\n        {{- tool | tojson }}\n    {%- endfor %}\n    {{- \"\\n</tools>\\n\\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\\n<tool_call>\\n{\\\"name\\\": <function-name>, \\\"arguments\\\": <args-json-object>}\\n</tool_call><|im_end|>\\n\" }}\n{%- else %}\n    {%- if messages[0]['role'] == 'system' %}\n        {{- '<|im_start|>system\\n' + messages[0]['content'] + '<|im_end|>\\n' }}\n  {%- endif %}\n{%- endif %}\n{%- for message in messages %}\n    {%- if (message.role == \"user\") or (message.role == \"system\" and not loop.first) %}\n        {{- '<|im_start|>' + message.role + '\\n' + message.content + '<|im_end|>' + '\\n' }}\n    {%- elif message.role == \"assistant\" and not message.tool_calls %}\n        {%- set content = message.content %}\n        {%- if not loop.last %}\n            {%- set content = message.content.split('</think>')[-1].lstrip('\\n') %}\n        {%- endif %}\n        {{- '<|im_start|>' + message.role + '\\n' + content + '<|im_end|>' + '\\n' }}\n    {%- elif message.role == \"assistant\" %}\n        {%- set content = message.content %}\n        {%- if not loop.last %}\n            {%- set content = message.content.split('</think>')[-1].lstrip('\\n') %}\n        {%- endif %}\n        {{- '<|im_start|>' + message.role }}\n        {%- if message.content %}\n            {{- '\\n' + content }}\n        {%- endif %}\n        {%- for tool_call in message.tool_calls %}\n            {%- if tool_call.function is defined %}\n                {%- set tool_call = tool_call.function %}\n            {%- endif %}\n            {{- '\\n<tool_call>\\n{\"name\": \"' }}\n            {{- tool_call.name }}\n            {{- '\", \"arguments\": ' }}\n            {{- tool_call.arguments | tojson }}\n            {{- '}\\n</tool_call>' }}\n        {%- endfor %}\n        {{- '<|im_end|>\\n' }}\n    {%- elif message.role == \"tool\" %}\n        {%- if (loop.index0 == 0) or (messages[loop.index0 - 1].role != \"tool\") %}\n            {{- '<|im_start|>user' }}\n        {%- endif %}\n        {{- '\\n<tool_response>\\n' }}\n        {{- message.content }}\n        {{- '\\n</tool_response>' }}\n        {%- if loop.last or (messages[loop.index0 + 1].role != \"tool\") %}\n            {{- '<|im_end|>\\n' }}\n        {%- endif %}\n    {%- endif %}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|im_start|>assistant\\n<think>\\n' }}\n{%- endif %}\n",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n<think>\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n<think>\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n<think>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"NY\\\"}\"}\n</tool_call><|im_end|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n\n\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": \"{\\\"location\\\":\\\"NY\\\"}\"}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n{\"temp\": 20}\n</tool_response><|im_end|>\n<|im_start|>assistant\n<think>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "Qwen/Qwen3-4B": {
    "template": "{%- if tools %}\n    {{- '<|im_start|>system\\n' }}\n    {%- if messages[0].role == 'system' %}\n        {{- messages[0].content + '\\n\\n' }}\n    {%- endif %}\n    {{- \"# Tools\\n\\nYou may call one or more functions to assist with the user query.\\n\\nYou are provided with function signatures within <tools></tools> XML tags:\\n<tools>\" }}\n    {%- for tool in tools %}\n        {{- \"\\n\" }}\n        {{- tool | tojson }}\n    {%- endfor %}\n    {{- \"\\n</tools>\\n\\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\\n<tool_call>\\n{\\\"name\\\": <function-name>, \\\"arguments\\\": <args-json-object>}\\n</tool_call><|im_end|>\\n\" }}\n{%- else %}\n    {%- if messages[0].role == 'system' %}\n        {{- '<|im_start|>system\\n' + messages[0].content + '<|im_end|>\\n' }}\n    {%- endif %}\n{%- endif %}\n{%- set ns = namespace(multi_step_tool=true, last_query_index=messages|length - 1) %}\n{%- for message in messages[::-1] %}\n    {%- set index = (messages|length - 1) - loop.index0 %}\n    {%- if ns.multi_step_tool and message.role == \"user\" and message.content is string and not(message.content.startswith('<tool_response>') and message.content.endswith('</tool_response>')) %}\n        {%- set ns.multi_step_tool = false %}\n        {%- set ns.last_query_index = index %}\n    {%- endif %}\n{%- endfor %}\n{%- for message in messages %}\n    {%- if message.content is string %}\n        {%- set content = message.content %}\n    {%- else %}\n        {%- set content = '' %}\n    {%- endif %}\n    {%- if (message.role == \"user\") or (message.role == \"system\" and not loop.first) %}\n        {{- '<|im_start|>' + message.role + '\\n' + content + '<|im_end|>' + '\\n' }}\n    {%- elif message.role == \"assistant\" %}\n        {%- set reasoning_content = '' %}\n        {%- if message.reasoning_content is string %}\n            {%- set reasoning_content = message.reasoning_content %}\n        {%- else %}\n            {%- if '</think>' in content %}\n                {%- set reasoning_content = content.split('</think>')[0].rstrip('\\n').split('<think>')[-1].lstrip('\\n') %}\n                {%- set content = content.split('</think>')[-1].lstrip('\\n') %}\n            {%- endif %}\n        {%- endif %}\n        {%- if loop.index0 > ns.last_query_index %}\n            {%- if loop.last or (not loop.last and reasoning_content) %}\n                {{- '<|im_start|>' + message.role + '\\n<think>\\n' + reasoning_content.strip('\\n') + '\\n</think>\\n\\n' + content.lstrip('\\n') }}\n            {%- else %}\n                {{- '<|im_start|>' + message.role + '\\n' + content }}\n            {%- endif %}\n        {%- else %}\n            {{- '<|im_start|>' + message.role + '\\n' + content }}\n        {%- endif %}\n        {%- if message.tool_calls %}\n            {%- for tool_call in message.tool_calls %}\n                {%- if (loop.first and content) or (not loop.first) %}\n                    {{- '\\n' }}\n                {%- endif %}\n                {%- if tool_call.function %}\n                    {%- set tool_call = tool_call.function %}\n                {%- endif %}\n                {{- '<tool_call>\\n{\"name\": \"' }}\n                {{- tool_call.name }}\n                {{- '\", \"arguments\": ' }}\n                {%- if tool_call.arguments is string %}\n                    {{- tool_call.arguments }}\n                {%- else %}\n                    {{- tool_call.arguments | tojson }}\n                {%- endif %}\n                {{- '}\\n</tool_call>' }}\n            {%- endfor %}\n        {%- endif %}\n        {{- '<|im_end|>\\n' }}\n    {%- elif message.role == \"tool\" %}\n        {%- if loop.first or (messages[loop.index0 - 1].role != \"tool\") %}\n            {{- '<|im_start|>user' }}\n        {%- endif %}\n        {{- '\\n<tool_response>\\n' }}\n        {{- content }}\n        {{- '\\n</tool_response>' }}\n        {%- if loop.last or (messages[loop.index0 + 1].role != \"tool\") %}\n            {{- '<|im_end|>\\n' }}\n        {%- endif %}\n    {%- endif %}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|im_start|>assistant\\n' }}\n    {%- if enable_thinking is defined and enable_thinking is false %}\n        {{- '<think>\\n\\n</think>\\n\\n' }}\n    {%- endif %}\n{%- endif %}",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call><|im_end|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n{\"temp\": 20}\n</tool_response><|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "parallel_tool_calls",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY and SF?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_1",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              },
              {
                "id": "call_2",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"SF\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_1",
            "name": "get_weather",
            "content": "20C"
          },
          {
            "role": "tool",
            "tool_call_id": "call_2",
            "name": "get_weather",
            "content": "15C"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY and SF?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call>\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"SF\"}}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n20C\n</tool_response>\n<tool_response>\n15C\n</tool_response><|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n<think>\nThinking process...\n</think>\n\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "Qwen/Qwen3-4B-Instruct-2507": {
    "template": "{%- if tools %}\n    {{- '<|im_start|>system\\n' }}\n    {%- if messages[0].role == 'system' %}\n        {{- messages[0].content + '\\n\\n' }}\n    {%- endif %}\n    {{- \"# Tools\\n\\nYou may call one or more functions to assist with the user query.\\n\\nYou are provided with function signatures within <tools></tools> XML tags:\\n<tools>\" }}\n    {%- for tool in tools %}\n        {{- \"\\n\" }}\n        {{- tool | tojson }}\n    {%- endfor %}\n    {{- \"\\n</tools>\\n\\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\\n<tool_call>\\n{\\\"name\\\": <function-name>, \\\"arguments\\\": <args-json-object>}\\n</tool_call><|im_end|>\\n\" }}\n{%- else %}\n    {%- if messages[0].role == 'system' %}\n        {{- '<|im_start|>system\\n' + messages[0].content + '<|im_end|>\\n' }}\n    {%- endif %}\n{%- endif %}\n{%- for message in messages %}\n    {%- if message.content is string %}\n        {%- set content = message.content %}\n    {%- else %}\n        {%- set content = '' %}\n    {%- endif %}\n    {%- if (message.role == \"user\") or (message.role == \"system\" and not loop.first) %}\n        {{- '<|im_start|>' + message.role + '\\n' + content + '<|im_end|>' + '\\n' }}\n    {%- elif message.role == \"assistant\" %}\n        {{- '<|im_start|>' + message.role + '\\n' + content }}\n        {%- if message.tool_calls %}\n            {%- for tool_call in message.tool_calls %}\n                {%- if (loop.first and content) or (not loop.first) %}\n                    {{- '\\n' }}\n                {%- endif %}\n                {%- if tool_call.function %}\n                    {%- set tool_call = tool_call.function %}\n                {%- endif %}\n                {{- '<tool_call>\\n{\"name\": \"' }}\n                {{- tool_call.name }}\n                {{- '\", \"arguments\": ' }}\n                {%- if tool_call.arguments is string %}\n                    {{- tool_call.arguments }}\n                {%- else %}\n                    {{- tool_call.arguments | tojson }}\n                {%- endif %}\n                {{- '}\\n</tool_call>' }}\n            {%- endfor %}\n        {%- endif %}\n        {{- '<|im_end|>\\n' }}\n    {%- elif message.role == \"tool\" %}\n        {%- if loop.first or (messages[loop.index0 - 1].role != \"tool\") %}\n            {{- '<|im_start|>user' }}\n        {%- endif %}\n        {{- '\\n<tool_response>\\n' }}\n        {{- content }}\n        {{- '\\n</tool_response>' }}\n        {%- if loop.last or (messages[loop.index0 + 1].role != \"tool\") %}\n            {{- '<|im_end|>\\n' }}\n        {%- endif %}\n    {%- endif %}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|im_start|>assistant\\n' }}\n{%- endif %}",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call><|im_end|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n{\"temp\": 20}\n</tool_response><|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "parallel_tool_calls",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY and SF?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_1",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              },
              {
                "id": "call_2",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"SF\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_1",
            "name": "get_weather",
            "content": "20C"
          },
          {
            "role": "tool",
            "tool_call_id": "call_2",
            "name": "get_weather",
            "content": "15C"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY and SF?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call>\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"SF\"}}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n20C\n</tool_response>\n<tool_response>\n15C\n</tool_response><|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "Qwen/Qwen3-4B-Thinking-2507": {
    "template": "{%- if tools %}\n    {{- '<|im_start|>system\\n' }}\n    {%- if messages[0].role == 'system' %}\n        {{- messages[0].content + '\\n\\n' }}\n    {%- endif %}\n    {{- \"# Tools\\n\\nYou may call one or more functions to assist with the user query.\\n\\nYou are provided with function signatures within <tools></tools> XML tags:\\n<tools>\" }}\n    {%- for tool in tools %}\n        {{- \"\\n\" }}\n        {{- tool | tojson }}\n    {%- endfor %}\n    {{- \"\\n</tools>\\n\\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\\n<tool_call>\\n{\\\"name\\\": <function-name>, \\\"arguments\\\": <args-json-object>}\\n</tool_call><|im_end|>\\n\" }}\n{%- else %}\n    {%- if messages[0].role == 'system' %}\n        {{- '<|im_start|>system\\n' + messages[0].content + '<|im_end|>\\n' }}\n    {%- endif %}\n{%- endif %}\n{%- set ns = namespace(multi_step_tool=true, last_query_index=messages|length - 1) %}\n{%- for message in messages[::-1] %}\n    {%- set index = (messages|length - 1) - loop.index0 %}\n    {%- if ns.multi_step_tool and message.role == \"user\" and message.content is string and not(message.content.startswith('<tool_response>') and message.content.endswith('</tool_response>')) %}\n        {%- set ns.multi_step_tool = false %}\n        {%- set ns.last_query_index = index %}\n    {%- endif %}\n{%- endfor %}\n{%- for message in messages %}\n    {%- if message.content is string %}\n        {%- set content = message.content %}\n    {%- else %}\n        {%- set content = '' %}\n    {%- endif %}\n    {%- if (message.role == \"user\") or (message.role == \"system\" and not loop.first) %}\n        {{- '<|im_start|>' + message.role + '\\n' + content + '<|im_end|>' + '\\n' }}\n    {%- elif message.role == \"assistant\" %}\n        {%- set reasoning_content = '' %}\n        {%- if message.reasoning_content is string %}\n            {%- set reasoning_content = message.reasoning_content %}\n        {%- else %}\n            {%- if '</think>' in content %}\n                {%- set reasoning_content = content.split('</think>')[0].rstrip('\\n').split('<think>')[-1].lstrip('\\n') %}\n                {%- set content = content.split('</think>')[-1].lstrip('\\n') %}\n            {%- endif %}\n        {%- endif %}\n        {%- if loop.index0 > ns.last_query_index %}\n            {%- if loop.last or (not loop.last and reasoning_content) %}\n                {{- '<|im_start|>' + message.role + '\\n<think>\\n' + reasoning_content.strip('\\n') + '\\n</think>\\n\\n' + content.lstrip('\\n') }}\n            {%- else %}\n                {{- '<|im_start|>' + message.role + '\\n' + content }}\n            {%- endif %}\n        {%- else %}\n            {{- '<|im_start|>' + message.role + '\\n' + content }}\n        {%- endif %}\n        {%- if message.tool_calls %}\n            {%- for tool_call in message.tool_calls %}\n                {%- if (loop.first and content) or (not loop.first) %}\n                    {{- '\\n' }}\n                {%- endif %}\n                {%- if tool_call.function %}\n                    {%- set tool_call = tool_call.function %}\n                {%- endif %}\n                {{- '<tool_call>\\n{\"name\": \"' }}\n                {{- tool_call.name }}\n                {{- '\", \"arguments\": ' }}\n                {%- if tool_call.arguments is string %}\n                    {{- tool_call.arguments }}\n                {%- else %}\n                    {{- tool_call.arguments | tojson }}\n                {%- endif %}\n                {{- '}\\n</tool_call>' }}\n            {%- endfor %}\n        {%- endif %}\n        {{- '<|im_end|>\\n' }}\n    {%- elif message.role == \"tool\" %}\n        {%- if loop.first or (messages[loop.index0 - 1].role != \"tool\") %}\n            {{- '<|im_start|>user' }}\n        {%- endif %}\n        {{- '\\n<tool_response>\\n' }}\n        {{- content }}\n        {{- '\\n</tool_response>' }}\n        {%- if loop.last or (messages[loop.index0 + 1].role != \"tool\") %}\n            {{- '<|im_end|>\\n' }}\n        {%- endif %}\n    {%- endif %}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|im_start|>assistant\\n<think>\\n' }}\n{%- endif %}",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n<think>\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n<think>\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n<think>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call><|im_end|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n{\"temp\": 20}\n</tool_response><|im_end|>\n<|im_start|>assistant\n<think>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "parallel_tool_calls",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY and SF?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_1",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              },
              {
                "id": "call_2",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"SF\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_1",
            "name": "get_weather",
            "content": "20C"
          },
          {
            "role": "tool",
            "tool_call_id": "call_2",
            "name": "get_weather",
            "content": "15C"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY and SF?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call>\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"SF\"}}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n20C\n</tool_response>\n<tool_response>\n15C\n</tool_response><|im_end|>\n<|im_start|>assistant\n<think>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n<think>\nThinking process...\n</think>\n\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "Qwen/Qwen3-VL-4B-Instruct": {
    "template": "{%- if tools %}\n    {{- '<|im_start|>system\\n' }}\n    {%- if messages[0].role == 'system' %}\n        {%- if messages[0].content is string %}\n            {{- messages[0].content }}\n        {%- else %}\n            {%- for content in messages[0].content %}\n                {%- if 'text' in content %}\n                    {{- content.text }}\n                {%- endif %}\n            {%- endfor %}\n        {%- endif %}\n        {{- '\\n\\n' }}\n    {%- endif %}\n    {{- \"# Tools\\n\\nYou may call one or more functions to assist with the user query.\\n\\nYou are provided with function signatures within <tools></tools> XML tags:\\n<tools>\" }}\n    {%- for tool in tools %}\n        {{- \"\\n\" }}\n        {{- tool | tojson }}\n    {%- endfor %}\n    {{- \"\\n</tools>\\n\\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\\n<tool_call>\\n{\\\"name\\\": <function-name>, \\\"arguments\\\": <args-json-object>}\\n</tool_call><|im_end|>\\n\" }}\n{%- else %}\n    {%- if messages[0].role == 'system' %}\n        {{- '<|im_start|>system\\n' }}\n        {%- if messages[0].content is string %}\n            {{- messages[0].content }}\n        {%- else %}\n            {%- for content in messages[0].content %}\n                {%- if 'text' in content %}\n                    {{- content.text }}\n                {%- endif %}\n            {%- endfor %}\n        {%- endif %}\n        {{- '<|im_end|>\\n' }}\n    {%- endif %}\n{%- endif %}\n{%- set image_count = namespace(value=0) %}\n{%- set video_count = namespace(value=0) %}\n{%- for message in messages %}\n    {%- if message.role == \"user\" %}\n        {{- '<|im_start|>' + message.role + '\\n' }}\n        {%- if message.content is string %}\n            {{- message.content }}\n        {%- else %}\n            {%- for content in message.content %}\n                {%- if content.type == 'image' or 'image' in content or 'image_url' in content %}\n                    {%- set image_count.value = image_count.value + 1 %}\n                    {%- if add_vision_id %}Picture {{ image_count.value }}: {% endif -%}\n                    <|vision_start|><|image_pad|><|vision_end|>\n                {%- elif content.type == 'video' or 'video' in content %}\n                    {%- set video_count.value = video_count.value + 1 %}\n                    {%- if add_vision_id %}Video {{ video_count.value }}: {% endif -%}\n                    <|vision_start|><|video_pad|><|vision_end|>\n                {%- elif 'text' in content %}\n                    {{- content.text }}\n                {%- endif %}\n            {%- endfor %}\n        {%- endif %}\n        {{- '<|im_end|>\\n' }}\n    {%- elif message.role == \"assistant\" %}\n        {{- '<|im_start|>' + message.role + '\\n' }}\n        {%- if message.content is string %}\n            {{- message.content }}\n        {%- else %}\n            {%- for content_item in message.content %}\n                {%- if 'text' in content_item %}\n                    {{- content_item.text }}\n                {%- endif %}\n            {%- endfor %}\n        {%- endif %}\n        {%- if message.tool_calls %}\n            {%- for tool_call in message.tool_calls %}\n                {%- if (loop.first and message.content) or (not loop.first) %}\n                    {{- '\\n' }}\n                {%- endif %}\n                {%- if tool_call.function %}\n                    {%- set tool_call = tool_call.function %}\n                {%- endif %}\n                {{- '<tool_call>\\n{\"name\": \"' }}\n                {{- tool_call.name }}\n                {{- '\", \"arguments\": ' }}\n                {%- if tool_call.arguments is string %}\n                    {{- tool_call.arguments }}\n                {%- else %}\n                    {{- tool_call.arguments | tojson }}\n                {%- endif %}\n                {{- '}\\n</tool_call>' }}\n            {%- endfor %}\n        {%- endif %}\n        {{- '<|im_end|>\\n' }}\n    {%- elif message.role == \"tool\" %}\n        {%- if loop.first or (messages[loop.index0 - 1].role != \"tool\") %}\n            {{- '<|im_start|>user' }}\n        {%- endif %}\n        {{- '\\n<tool_response>\\n' }}\n        {%- if message.content is string %}\n            {{- message.content }}\n        {%- else %}\n            {%- for content in message.content %}\n                {%- if content.type == 'image' or 'image' in content or 'image_url' in content %}\n                    {%- set image_count.value = image_count.value + 1 %}\n                    {%- if add_vision_id %}Picture {{ image_count.value }}: {% endif -%}\n                    <|vision_start|><|image_pad|><|vision_end|>\n                {%- elif content.type == 'video' or 'video' in content %}\n                    {%- set video_count.value = video_count.value + 1 %}\n                    {%- if add_vision_id %}Video {{ video_count.value }}: {% endif -%}\n                    <|vision_start|><|video_pad|><|vision_end|>\n                {%- elif 'text' in content %}\n                    {{- content.text }}\n                {%- endif %}\n            {%- endfor %}\n        {%- endif %}\n        {{- '\\n</tool_response>' }}\n        {%- if loop.last or (messages[loop.index0 + 1].role != \"tool\") %}\n            {{- '<|im_end|>\\n' }}\n        {%- endif %}\n    {%- endif %}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|im_start|>assistant\\n' }}\n{%- endif %}\n",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call><|im_end|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n{\"temp\": 20}\n</tool_response><|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "parallel_tool_calls",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY and SF?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_1",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              },
              {
                "id": "call_2",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"SF\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_1",
            "name": "get_weather",
            "content": "20C"
          },
          {
            "role": "tool",
            "tool_call_id": "call_2",
            "name": "get_weather",
            "content": "15C"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY and SF?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call>\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"SF\"}}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n20C\n</tool_response>\n<tool_response>\n15C\n</tool_response><|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "Qwen/Qwen3-VL-4B-Thinking": {
    "template": "{%- set image_count = namespace(value=0) %}\n{%- set video_count = namespace(value=0) %}\n{%- macro render_content(content, do_vision_count) %}\n    {%- if content is string %}\n        {{- content }}\n    {%- else %}\n        {%- for item in content %}\n            {%- if 'image' in item or 'image_url' in item or item.type == 'image' %}\n                {%- if do_vision_count %}\n                    {%- set image_count.value = image_count.value + 1 %}\n                {%- endif %}\n                {%- if add_vision_id %}Picture {{ image_count.value }}: {% endif -%}\n                <|vision_start|><|image_pad|><|vision_end|>\n            {%- elif 'video' in item or item.type == 'video' %}\n                {%- if do_vision_count %}\n                    {%- set video_count.value = video_count.value + 1 %}\n                {%- endif %}\n                {%- if add_vision_id %}Video {{ video_count.value }}: {% endif -%}\n                <|vision_start|><|video_pad|><|vision_end|>\n            {%- elif 'text' in item %}\n                {{- item.text }}\n            {%- endif %}\n        {%- endfor %}\n    {%- endif %}\n{%- endmacro %}\n{%- if tools %}\n    {{- '<|im_start|>system\\n' }}\n    {%- if messages[0].role == 'system' %}\n        {{- render_content(messages[0].content, false) + '\\n\\n' }}\n    {%- endif %}\n    {{- \"# Tools\\n\\nYou may call one or more functions to assist with the user query.\\n\\nYou are provided with function signatures within <tools></tools> XML tags:\\n<tools>\" }}\n    {%- for tool in tools %}\n        {{- \"\\n\" }}\n        {{- tool | tojson }}\n    {%- endfor %}\n    {{- \"\\n</tools>\\n\\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\\n<tool_call>\\n{\\\"name\\\": <function-name>, \\\"arguments\\\": <args-json-object>}\\n</tool_call><|im_end|>\\n\" }}\n{%- else %}\n    {%- if messages[0].role == 'system' %}\n        {{- '<|im_start|>system\\n' + render_content(messages[0].content, false) + '<|im_end|>\\n' }}\n    {%- endif %}\n{%- endif %}\n{%- set ns = namespace(multi_step_tool=true, last_query_index=messages|length - 1) %}\n{%- for message in messages[::-1] %}\n    {%- set index = (messages|length - 1) - loop.index0 %}\n    {%- if ns.multi_step_tool and message.role == \"user\" %}\n        {%- set content = render_content(message.content, false) %}\n        {%- if not(content.startswith('<tool_response>') and content.endswith('</tool_response>')) %}\n            {%- set ns.multi_step_tool = false %}\n            {%- set ns.last_query_index = index %}\n        {%- endif %}\n    {%- endif %}\n{%- endfor %}\n{%- for message in messages %}\n    {%- set content = render_content(message.content, True) %}\n    {%- if (message.role == \"user\") or (message.role == \"system\" and not loop.first) %}\n        {{- '<|im_start|>' + message.role + '\\n' + content + '<|im_end|>' + '\\n' }}\n    {%- elif message.role == \"assistant\" %}\n        {%- set reasoning_content = '' %}\n        {%- if message.reasoning_content is string %}\n            {%- set reasoning_content = message.reasoning_content %}\n        {%- else %}\n            {%- if '</think>' in content %}\n                {%- set reasoning_content = content.split('</think>')[0].rstrip('\\n').split('<think>')[-1].lstrip('\\n') %}\n                {%- set content = content.split('</think>')[-1].lstrip('\\n') %}\n            {%- endif %}\n        {%- endif %}\n        {%- if loop.index0 > ns.last_query_index %}\n            {%- if loop.last or (not loop.last and reasoning_content) %}\n                {{- '<|im_start|>' + message.role + '\\n<think>\\n' + reasoning_content.strip('\\n') + '\\n</think>\\n\\n' + content.lstrip('\\n') }}\n            {%- else %}\n                {{- '<|im_start|>' + message.role + '\\n' + content }}\n            {%- endif %}\n        {%- else %}\n            {{- '<|im_start|>' + message.role + '\\n' + content }}\n        {%- endif %}\n        {%- if message.tool_calls %}\n            {%- for tool_call in message.tool_calls %}\n                {%- if (loop.first and content) or (not loop.first) %}\n                    {{- '\\n' }}\n                {%- endif %}\n                {%- if tool_call.function %}\n                    {%- set tool_call = tool_call.function %}\n                {%- endif %}\n                {{- '<tool_call>\\n{\"name\": \"' }}\n                {{- tool_call.name }}\n                {{- '\", \"arguments\": ' }}\n                {%- if tool_call.arguments is string %}\n                    {{- tool_call.arguments }}\n                {%- else %}\n                    {{- tool_call.arguments | tojson }}\n                {%- endif %}\n                {{- '}\\n</tool_call>' }}\n            {%- endfor %}\n        {%- endif %}\n        {{- '<|im_end|>\\n' }}\n    {%- elif message.role == \"tool\" %}\n        {%- if loop.first or (messages[loop.index0 - 1].role != \"tool\") %}\n            {{- '<|im_start|>user' }}\n        {%- endif %}\n        {{- '\\n<tool_response>\\n' }}\n        {{- content }}\n        {{- '\\n</tool_response>' }}\n        {%- if loop.last or (messages[loop.index0 + 1].role != \"tool\") %}\n            {{- '<|im_end|>\\n' }}\n        {%- endif %}\n    {%- endif %}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|im_start|>assistant\\n<think>\\n' }}\n{%- endif %}\n",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n<think>\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n<think>\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n<think>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call><|im_end|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n{\"temp\": 20}\n</tool_response><|im_end|>\n<|im_start|>assistant\n<think>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "parallel_tool_calls",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY and SF?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_1",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              },
              {
                "id": "call_2",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"SF\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_1",
            "name": "get_weather",
            "content": "20C"
          },
          {
            "role": "tool",
            "tool_call_id": "call_2",
            "name": "get_weather",
            "content": "15C"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call><|im_end|>\n<|im_start|>user\nWeather in NY and SF?<|im_end|>\n<|im_start|>assistant\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"NY\"}}\n</tool_call>\n<tool_call>\n{\"name\": \"get_weather\", \"arguments\": {\"location\":\"SF\"}}\n</tool_call><|im_end|>\n<|im_start|>user\n<tool_response>\n20C\n</tool_response>\n<tool_response>\n15C\n</tool_response><|im_end|>\n<|im_start|>assistant\n<think>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n<think>\nThinking process...\n</think>\n\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "Qwen/Qwen3Guard-Gen-4B": {
    "template": "{%- if messages|length > 0 -%}\n    {%- if messages[-1].role == \"user\" -%}\n        {{- \"<|im_start|>user\n# Task:\n1) Evaluate whether THE LAST USER's query belongs to safe or unsafe content based on our safety policy.\n2) Identify the category of unsafe content found.\n\n<BEGIN SAFETY POLICY>\n**Safety: Safe**: The USER's query does not contain any prohibited content or content that could lead to prohibited content.\n**Safety: Unsafe**: The USER's query contains prohibited content.\n**Safety: Controversial**: The USER's query does not explicitly contain prohibited content, but its intent, context, or potential responses could be misinterpreted, misused, or exploited to generate unsafe content under certain conditions.\n<END SAFETY POLICY>\n\n<BEGIN UNSAFE CONTENT CATEGORIES>\nViolent.\nNon-violent Illegal Acts.\nSexual Content or Sexual Acts.\nPII.\nSuicide & Self-Harm.\nUnethical Acts.\nPolitically Sensitive Topics.\nCopyright Violation.\nJailbreak.\n<END UNSAFE CONTENT CATEGORIES>\n\n<BEGIN CONVERSATION>\n\n\" -}}\n        {%- set template = \"\n\n<END CONVERSATION>\n\nProvide your safety assessment for ONLY THE LAST **USER's query** in the above conversation:\n - The first line must be one of: 'Safety: Safe', 'Safety: Unsafe', 'Safety: Controversial'.\n - The second line should start with 'Categories:' followed by a list of any unsafe content categories, separated by commas. If the content is safe, use 'Categories: None'.<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n\" -%}\n    {%- else -%}\n        {{- \"<|im_start|>user\n# Task:\n1) Evaluate whether THE LAST ASSISTANT's response belongs to safe or unsafe content based on our safety policy.\n2) Identify the category of unsafe content found.\n3) Determine if THE LAST ASSISTANT's response is a refusal to the USER's query.\n\n<BEGIN SAFETY POLICY>\n**Safety: Safe**: The ASSISTANT's response does not contain any prohibited content or content that could lead to prohibited content.\n**Safety: Unsafe**: The ASSISTANT's response contains prohibited content.\n**Safety: Controversial**: The ASSISTANT's response is not explicitly harmful, but could become risky or offensive depending on context or audience.\n<END SAFETY POLICY>\n\n<BEGIN UNSAFE CONTENT CATEGORIES>\nViolent.\nNon-violent Illegal Acts.\nSexual Content or Sexual Acts.\nPII.\nSuicide & Self-Harm.\nUnethical Acts.\nPolitically Sensitive Topics.\nCopyright Violation.\n<END UNSAFE CONTENT CATEGORIES>\n\n<BEGIN REFUSAL POLICY>\n**Refusal: Yes**: The ASSISTANT refused to answer or did not comply with the USER's request.\n**Refusal: No**: The ASSISTANT directly answered or complied with the USER's request.\n<END REFUSAL POLICY>\n\n<BEGIN CONVERSATION>\n\n\" -}}\n        {%- set template = \"\n\n<END CONVERSATION>\n\nProvide your safety assessment for ONLY THE LAST **ASSISTANT's response** in the above conversation:\n - The first line must be one of: 'Safety: Safe', 'Safety: Unsafe', 'Safety: Controversial'.\n - The second line should start with 'Categories:' followed by a list of any unsafe content categories, separated by commas. If the content is safe, use 'Categories: None'.\n - The third line must be one of: 'Refusal: Yes', 'Refusal: No'.<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n\" -%}\n    {%- endif -%}\n    {%- for message in messages -%}\n        {%- if loop.first -%}\n            {%- if message.role == \"system\" -%}\n                {{- \"USER: \" + message.content -}}\n            {%- elif message.role == \"user\" -%}\n                {{- \"USER: \" + message.content -}}\n            {%- endif -%}\n        {%- else -%}\n            {%- if loop.index0 > 0 and messages[loop.index0 - 1].role == \"system\" and message.role == \"user\" -%}\n                {{- \"\n\n\"+message.content -}}\n            {%- else -%}   \n                {%- if message.role == \"assistant\" -%}\n                    {{- \"\n\nASSISTANT: \" + message.content -}}\n                {%- elif message.role == \"user\" -%}\n                    {{- \"\n\nUSER: \" + message.content -}}\n                {%- endif -%}\n            {%- endif -%}\n        {%- endif -%}\n    {%- endfor -%}\n    {{- template -}}\n{%- endif -%}",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\n# Task:\n1) Evaluate whether THE LAST USER's query belongs to safe or unsafe content based on our safety policy.\n2) Identify the category of unsafe content found.\n\n<BEGIN SAFETY POLICY>\n**Safety: Safe**: The USER's query does not contain any prohibited content or content that could lead to prohibited content.\n**Safety: Unsafe**: The USER's query contains prohibited content.\n**Safety: Controversial**: The USER's query does not explicitly contain prohibited content, but its intent, context, or potential responses could be misinterpreted, misused, or exploited to generate unsafe content under certain conditions.\n<END SAFETY POLICY>\n\n<BEGIN UNSAFE CONTENT CATEGORIES>\nViolent.\nNon-violent Illegal Acts.\nSexual Content or Sexual Acts.\nPII.\nSuicide & Self-Harm.\nUnethical Acts.\nPolitically Sensitive Topics.\nCopyright Violation.\nJailbreak.\n<END UNSAFE CONTENT CATEGORIES>\n\n<BEGIN CONVERSATION>\n\nUSER: Hi\n\n<END CONVERSATION>\n\nProvide your safety assessment for ONLY THE LAST **USER's query** in the above conversation:\n - The first line must be one of: 'Safety: Safe', 'Safety: Unsafe', 'Safety: Controversial'.\n - The second line should start with 'Categories:' followed by a list of any unsafe content categories, separated by commas. If the content is safe, use 'Categories: None'.<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\n# Task:\n1) Evaluate whether THE LAST ASSISTANT's response belongs to safe or unsafe content based on our safety policy.\n2) Identify the category of unsafe content found.\n3) Determine if THE LAST ASSISTANT's response is a refusal to the USER's query.\n\n<BEGIN SAFETY POLICY>\n**Safety: Safe**: The ASSISTANT's response does not contain any prohibited content or content that could lead to prohibited content.\n**Safety: Unsafe**: The ASSISTANT's response contains prohibited content.\n**Safety: Controversial**: The ASSISTANT's response is not explicitly harmful, but could become risky or offensive depending on context or audience.\n<END SAFETY POLICY>\n\n<BEGIN UNSAFE CONTENT CATEGORIES>\nViolent.\nNon-violent Illegal Acts.\nSexual Content or Sexual Acts.\nPII.\nSuicide & Self-Harm.\nUnethical Acts.\nPolitically Sensitive Topics.\nCopyright Violation.\n<END UNSAFE CONTENT CATEGORIES>\n\n<BEGIN REFUSAL POLICY>\n**Refusal: Yes**: The ASSISTANT refused to answer or did not comply with the USER's request.\n**Refusal: No**: The ASSISTANT directly answered or complied with the USER's request.\n<END REFUSAL POLICY>\n\n<BEGIN CONVERSATION>\n\nUSER: You are a helper.\n\nWho are you?\n\nASSISTANT: I am AI.\n\n<END CONVERSATION>\n\nProvide your safety assessment for ONLY THE LAST **ASSISTANT's response** in the above conversation:\n - The first line must be one of: 'Safety: Safe', 'Safety: Unsafe', 'Safety: Controversial'.\n - The second line should start with 'Categories:' followed by a list of any unsafe content categories, separated by commas. If the content is safe, use 'Categories: None'.\n - The third line must be one of: 'Refusal: Yes', 'Refusal: No'.<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\n# Task:\n1) Evaluate whether THE LAST USER's query belongs to safe or unsafe content based on our safety policy.\n2) Identify the category of unsafe content found.\n\n<BEGIN SAFETY POLICY>\n**Safety: Safe**: The USER's query does not contain any prohibited content or content that could lead to prohibited content.\n**Safety: Unsafe**: The USER's query contains prohibited content.\n**Safety: Controversial**: The USER's query does not explicitly contain prohibited content, but its intent, context, or potential responses could be misinterpreted, misused, or exploited to generate unsafe content under certain conditions.\n<END SAFETY POLICY>\n\n<BEGIN UNSAFE CONTENT CATEGORIES>\nViolent.\nNon-violent Illegal Acts.\nSexual Content or Sexual Acts.\nPII.\nSuicide & Self-Harm.\nUnethical Acts.\nPolitically Sensitive Topics.\nCopyright Violation.\nJailbreak.\n<END UNSAFE CONTENT CATEGORIES>\n\n<BEGIN CONVERSATION>\n\nUSER: Part 1\n\nUSER: Part 2\n\n<END CONVERSATION>\n\nProvide your safety assessment for ONLY THE LAST **USER's query** in the above conversation:\n - The first line must be one of: 'Safety: Safe', 'Safety: Unsafe', 'Safety: Controversial'.\n - The second line should start with 'Categories:' followed by a list of any unsafe content categories, separated by commas. If the content is safe, use 'Categories: None'.<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\n# Task:\n1) Evaluate whether THE LAST USER's query belongs to safe or unsafe content based on our safety policy.\n2) Identify the category of unsafe content found.\n\n<BEGIN SAFETY POLICY>\n**Safety: Safe**: The USER's query does not contain any prohibited content or content that could lead to prohibited content.\n**Safety: Unsafe**: The USER's query contains prohibited content.\n**Safety: Controversial**: The USER's query does not explicitly contain prohibited content, but its intent, context, or potential responses could be misinterpreted, misused, or exploited to generate unsafe content under certain conditions.\n<END SAFETY POLICY>\n\n<BEGIN UNSAFE CONTENT CATEGORIES>\nViolent.\nNon-violent Illegal Acts.\nSexual Content or Sexual Acts.\nPII.\nSuicide & Self-Harm.\nUnethical Acts.\nPolitically Sensitive Topics.\nCopyright Violation.\nJailbreak.\n<END UNSAFE CONTENT CATEGORIES>\n\n<BEGIN CONVERSATION>\n\nUSER: Hello\n\n<END CONVERSATION>\n\nProvide your safety assessment for ONLY THE LAST **USER's query** in the above conversation:\n - The first line must be one of: 'Safety: Safe', 'Safety: Unsafe', 'Safety: Controversial'.\n - The second line should start with 'Categories:' followed by a list of any unsafe content categories, separated by commas. If the content is safe, use 'Categories: None'.<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\n# Task:\n1) Evaluate whether THE LAST USER's query belongs to safe or unsafe content based on our safety policy.\n2) Identify the category of unsafe content found.\n\n<BEGIN SAFETY POLICY>\n**Safety: Safe**: The USER's query does not contain any prohibited content or content that could lead to prohibited content.\n**Safety: Unsafe**: The USER's query contains prohibited content.\n**Safety: Controversial**: The USER's query does not explicitly contain prohibited content, but its intent, context, or potential responses could be misinterpreted, misused, or exploited to generate unsafe content under certain conditions.\n<END SAFETY POLICY>\n\n<BEGIN UNSAFE CONTENT CATEGORIES>\nViolent.\nNon-violent Illegal Acts.\nSexual Content or Sexual Acts.\nPII.\nSuicide & Self-Harm.\nUnethical Acts.\nPolitically Sensitive Topics.\nCopyright Violation.\nJailbreak.\n<END UNSAFE CONTENT CATEGORIES>\n\n<BEGIN CONVERSATION>\n\nUSER: Hello\n\n<END CONVERSATION>\n\nProvide your safety assessment for ONLY THE LAST **USER's query** in the above conversation:\n - The first line must be one of: 'Safety: Safe', 'Safety: Unsafe', 'Safety: Controversial'.\n - The second line should start with 'Categories:' followed by a list of any unsafe content categories, separated by commas. If the content is safe, use 'Categories: None'.<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\n# Task:\n1) Evaluate whether THE LAST USER's query belongs to safe or unsafe content based on our safety policy.\n2) Identify the category of unsafe content found.\n\n<BEGIN SAFETY POLICY>\n**Safety: Safe**: The USER's query does not contain any prohibited content or content that could lead to prohibited content.\n**Safety: Unsafe**: The USER's query contains prohibited content.\n**Safety: Controversial**: The USER's query does not explicitly contain prohibited content, but its intent, context, or potential responses could be misinterpreted, misused, or exploited to generate unsafe content under certain conditions.\n<END SAFETY POLICY>\n\n<BEGIN UNSAFE CONTENT CATEGORIES>\nViolent.\nNon-violent Illegal Acts.\nSexual Content or Sexual Acts.\nPII.\nSuicide & Self-Harm.\nUnethical Acts.\nPolitically Sensitive Topics.\nCopyright Violation.\nJailbreak.\n<END UNSAFE CONTENT CATEGORIES>\n\n<BEGIN CONVERSATION>\n\nUSER: Hello\n\n<END CONVERSATION>\n\nProvide your safety assessment for ONLY THE LAST **USER's query** in the above conversation:\n - The first line must be one of: 'Safety: Safe', 'Safety: Unsafe', 'Safety: Controversial'.\n - The second line should start with 'Categories:' followed by a list of any unsafe content categories, separated by commas. If the content is safe, use 'Categories: None'.<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\n# Task:\n1) Evaluate whether THE LAST USER's query belongs to safe or unsafe content based on our safety policy.\n2) Identify the category of unsafe content found.\n\n<BEGIN SAFETY POLICY>\n**Safety: Safe**: The USER's query does not contain any prohibited content or content that could lead to prohibited content.\n**Safety: Unsafe**: The USER's query contains prohibited content.\n**Safety: Controversial**: The USER's query does not explicitly contain prohibited content, but its intent, context, or potential responses could be misinterpreted, misused, or exploited to generate unsafe content under certain conditions.\n<END SAFETY POLICY>\n\n<BEGIN UNSAFE CONTENT CATEGORIES>\nViolent.\nNon-violent Illegal Acts.\nSexual Content or Sexual Acts.\nPII.\nSuicide & Self-Harm.\nUnethical Acts.\nPolitically Sensitive Topics.\nCopyright Violation.\nJailbreak.\n<END UNSAFE CONTENT CATEGORIES>\n\n<BEGIN CONVERSATION>\n\nUSER: Hi\n\n<END CONVERSATION>\n\nProvide your safety assessment for ONLY THE LAST **USER's query** in the above conversation:\n - The first line must be one of: 'Safety: Safe', 'Safety: Unsafe', 'Safety: Controversial'.\n - The second line should start with 'Categories:' followed by a list of any unsafe content categories, separated by commas. If the content is safe, use 'Categories: None'.<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\n# Task:\n1) Evaluate whether THE LAST ASSISTANT's response belongs to safe or unsafe content based on our safety policy.\n2) Identify the category of unsafe content found.\n3) Determine if THE LAST ASSISTANT's response is a refusal to the USER's query.\n\n<BEGIN SAFETY POLICY>\n**Safety: Safe**: The ASSISTANT's response does not contain any prohibited content or content that could lead to prohibited content.\n**Safety: Unsafe**: The ASSISTANT's response contains prohibited content.\n**Safety: Controversial**: The ASSISTANT's response is not explicitly harmful, but could become risky or offensive depending on context or audience.\n<END SAFETY POLICY>\n\n<BEGIN UNSAFE CONTENT CATEGORIES>\nViolent.\nNon-violent Illegal Acts.\nSexual Content or Sexual Acts.\nPII.\nSuicide & Self-Harm.\nUnethical Acts.\nPolitically Sensitive Topics.\nCopyright Violation.\n<END UNSAFE CONTENT CATEGORIES>\n\n<BEGIN REFUSAL POLICY>\n**Refusal: Yes**: The ASSISTANT refused to answer or did not comply with the USER's request.\n**Refusal: No**: The ASSISTANT directly answered or complied with the USER's request.\n<END REFUSAL POLICY>\n\n<BEGIN CONVERSATION>\n\nUSER: Weather in NY?\n\nASSISTANT: \n\n<END CONVERSATION>\n\nProvide your safety assessment for ONLY THE LAST **ASSISTANT's response** in the above conversation:\n - The first line must be one of: 'Safety: Safe', 'Safety: Unsafe', 'Safety: Controversial'.\n - The second line should start with 'Categories:' followed by a list of any unsafe content categories, separated by commas. If the content is safe, use 'Categories: None'.\n - The third line must be one of: 'Refusal: Yes', 'Refusal: No'.<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\n# Task:\n1) Evaluate whether THE LAST ASSISTANT's response belongs to safe or unsafe content based on our safety policy.\n2) Identify the category of unsafe content found.\n3) Determine if THE LAST ASSISTANT's response is a refusal to the USER's query.\n\n<BEGIN SAFETY POLICY>\n**Safety: Safe**: The ASSISTANT's response does not contain any prohibited content or content that could lead to prohibited content.\n**Safety: Unsafe**: The ASSISTANT's response contains prohibited content.\n**Safety: Controversial**: The ASSISTANT's response is not explicitly harmful, but could become risky or offensive depending on context or audience.\n<END SAFETY POLICY>\n\n<BEGIN UNSAFE CONTENT CATEGORIES>\nViolent.\nNon-violent Illegal Acts.\nSexual Content or Sexual Acts.\nPII.\nSuicide & Self-Harm.\nUnethical Acts.\nPolitically Sensitive Topics.\nCopyright Violation.\n<END UNSAFE CONTENT CATEGORIES>\n\n<BEGIN REFUSAL POLICY>\n**Refusal: Yes**: The ASSISTANT refused to answer or did not comply with the USER's request.\n**Refusal: No**: The ASSISTANT directly answered or complied with the USER's request.\n<END REFUSAL POLICY>\n\n<BEGIN CONVERSATION>\n\nUSER: Solve\n\nASSISTANT: 42\n\n<END CONVERSATION>\n\nProvide your safety assessment for ONLY THE LAST **ASSISTANT's response** in the above conversation:\n - The first line must be one of: 'Safety: Safe', 'Safety: Unsafe', 'Safety: Controversial'.\n - The second line should start with 'Categories:' followed by a list of any unsafe content categories, separated by commas. If the content is safe, use 'Categories: None'.\n - The third line must be one of: 'Refusal: Yes', 'Refusal: No'.<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\n# Task:\n1) Evaluate whether THE LAST USER's query belongs to safe or unsafe content based on our safety policy.\n2) Identify the category of unsafe content found.\n\n<BEGIN SAFETY POLICY>\n**Safety: Safe**: The USER's query does not contain any prohibited content or content that could lead to prohibited content.\n**Safety: Unsafe**: The USER's query contains prohibited content.\n**Safety: Controversial**: The USER's query does not explicitly contain prohibited content, but its intent, context, or potential responses could be misinterpreted, misused, or exploited to generate unsafe content under certain conditions.\n<END SAFETY POLICY>\n\n<BEGIN UNSAFE CONTENT CATEGORIES>\nViolent.\nNon-violent Illegal Acts.\nSexual Content or Sexual Acts.\nPII.\nSuicide & Self-Harm.\nUnethical Acts.\nPolitically Sensitive Topics.\nCopyright Violation.\nJailbreak.\n<END UNSAFE CONTENT CATEGORIES>\n\n<BEGIN CONVERSATION>\n\nUSER: Current Date: 2025-12-16\n\nDate?\n\n<END CONVERSATION>\n\nProvide your safety assessment for ONLY THE LAST **USER's query** in the above conversation:\n - The first line must be one of: 'Safety: Safe', 'Safety: Unsafe', 'Safety: Controversial'.\n - The second line should start with 'Categories:' followed by a list of any unsafe content categories, separated by commas. If the content is safe, use 'Categories: None'.<|im_end|>\n<|im_start|>assistant\n<think>\n\n</think>\n\n"
      }
    ]
  },
  "Qwen/Qwen3-Coder-30B-A3B-Instruct": {
    "template": "{% macro render_extra_keys(json_dict, handled_keys) %}\n    {%- if json_dict is mapping %}\n        {%- for json_key in json_dict if json_key not in handled_keys %}\n            {%- if json_dict[json_key] is mapping or (json_dict[json_key] is sequence and json_dict[json_key] is not string) %}\n                {{- '\\n<' ~ json_key ~ '>' ~ (json_dict[json_key] | tojson | safe) ~ '</' ~ json_key ~ '>' }}\n            {%- else %}\n                {{-'\\n<' ~ json_key ~ '>' ~ (json_dict[json_key] | string) ~ '</' ~ json_key ~ '>' }}\n            {%- endif %}\n        {%- endfor %}\n    {%- endif %}\n{% endmacro %}\n\n{%- if messages[0][\"role\"] == \"system\" %}\n    {%- set system_message = messages[0][\"content\"] %}\n    {%- set loop_messages = messages[1:] %}\n{%- else %}\n    {%- set loop_messages = messages %}\n{%- endif %}\n\n{%- if not tools is defined %}\n    {%- set tools = [] %}\n{%- endif %}\n\n{%- if system_message is defined %}\n    {{- \"<|im_start|>system\\n\" + system_message }}\n{%- else %}\n    {%- if tools is iterable and tools | length > 0 %}\n        {{- \"<|im_start|>system\\nYou are Qwen, a helpful AI assistant that can interact with a computer to solve tasks.\" }}\n    {%- endif %}\n{%- endif %}\n{%- if tools is iterable and tools | length > 0 %}\n    {{- \"\\n\\n# Tools\\n\\nYou have access to the following functions:\\n\\n\" }}\n    {{- \"<tools>\" }}\n    {%- for tool in tools %}\n        {%- if tool.function is defined %}\n            {%- set tool = tool.function %}\n        {%- endif %}\n        {{- \"\\n<function>\\n<name>\" ~ tool.name ~ \"</name>\" }}\n        {%- if tool.description is defined %}\n            {{- '\\n<description>' ~ (tool.description | trim) ~ '</description>' }}\n        {%- endif %}\n        {{- '\\n<parameters>' }}\n        {%- if tool.parameters is defined and tool.parameters is mapping and tool.parameters.properties is defined and tool.parameters.properties is mapping %}\n            {%- for param_name, param_fields in tool.parameters.properties|items %}\n                {{- '\\n<parameter>' }}\n                {{- '\\n<name>' ~ param_name ~ '</name>' }}\n                {%- if param_fields.type is defined %}\n                    {{- '\\n<type>' ~ (param_fields.type | string) ~ '</type>' }}\n                {%- endif %}\n                {%- if param_fields.description is defined %}\n                    {{- '\\n<description>' ~ (param_fields.description | trim) ~ '</description>' }}\n                {%- endif %}\n                {%- set handled_keys = ['name', 'type', 'description'] %}\n                {{- render_extra_keys(param_fields, handled_keys) }}\n                {{- '\\n</parameter>' }}\n            {%- endfor %}\n        {%- endif %}\n        {% set handled_keys = ['type', 'properties'] %}\n        {{- render_extra_keys(tool.parameters, handled_keys) }}\n        {{- '\\n</parameters>' }}\n        {%- set handled_keys = ['type', 'name', 'description', 'parameters'] %}\n        {{- render_extra_keys(tool, handled_keys) }}\n        {{- '\\n</function>' }}\n    {%- endfor %}\n    {{- \"\\n</tools>\" }}\n    {{- '\\n\\nIf you choose to call a function ONLY reply in the following format with NO suffix:\\n\\n<tool_call>\\n<function=example_function_name>\\n<parameter=example_parameter_1>\\nvalue_1\\n</parameter>\\n<parameter=example_parameter_2>\\nThis is the value for the second parameter\\nthat can span\\nmultiple lines\\n</parameter>\\n</function>\\n</tool_call>\\n\\n<IMPORTANT>\\nReminder:\\n- Function calls MUST follow the specified format: an inner <function=...></function> block must be nested within <tool_call></tool_call> XML tags\\n- Required parameters MUST be specified\\n- You may provide optional reasoning for your function call in natural language BEFORE the function call, but NOT after\\n- If there is no function call available, answer the question like normal with your current knowledge and do not tell the user about function calls\\n</IMPORTANT>' }}\n{%- endif %}\n{%- if system_message is defined %}\n    {{- '<|im_end|>\\n' }}\n{%- else %}\n    {%- if tools is iterable and tools | length > 0 %}\n        {{- '<|im_end|>\\n' }}\n    {%- endif %}\n{%- endif %}\n{%- for message in loop_messages %}\n    {%- if message.role == \"assistant\" and message.tool_calls is defined and message.tool_calls is iterable and message.tool_calls | length > 0 %}\n        {{- '<|im_start|>' + message.role }}\n        {%- if message.content is defined and message.content is string and message.content | trim | length > 0 %}\n            {{- '\\n' + message.content | trim + '\\n' }}\n        {%- endif %}\n        {%- for tool_call in message.tool_calls %}\n            {%- if tool_call.function is defined %}\n                {%- set tool_call = tool_call.function %}\n            {%- endif %}\n            {{- '\\n<tool_call>\\n<function=' + tool_call.name + '>\\n' }}\n            {%- if tool_call.arguments is defined %}\n                {%- for args_name, args_value in tool_call.arguments|items %}\n                    {{- '<parameter=' + args_name + '>\\n' }}\n                    {%- set args_value = args_value | tojson | safe if args_value is mapping or (args_value is sequence and args_value is not string) else args_value | string %}\n                    {{- args_value }}\n                    {{- '\\n</parameter>\\n' }}\n                {%- endfor %}\n            {%- endif %}\n            {{- '</function>\\n</tool_call>' }}\n        {%- endfor %}\n        {{- '<|im_end|>\\n' }}\n    {%- elif message.role == \"user\" or message.role == \"system\" or message.role == \"assistant\" %}\n        {{- '<|im_start|>' + message.role + '\\n' + message.content + '<|im_end|>' + '\\n' }}\n    {%- elif message.role == \"tool\" %}\n        {%- if loop.previtem and loop.previtem.role != \"tool\" %}\n            {{- '<|im_start|>user\\n' }}\n        {%- endif %}\n        {{- '<tool_response>\\n' }}\n        {{- message.content }}\n        {{- '\\n</tool_response>\\n' }}\n        {%- if not loop.last and loop.nextitem.role != \"tool\" %}\n            {{- '<|im_end|>\\n' }}\n        {%- elif loop.last %}\n            {{- '<|im_end|>\\n' }}\n        {%- endif %}\n    {%- else %}\n        {{- '<|im_start|>' + message.role + '\\n' + message.content + '<|im_end|>\\n' }}\n    {%- endif %}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|im_start|>assistant\\n' }}\n{%- endif %}\n",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are Qwen, a helpful AI assistant that can interact with a computer to solve tasks.\n\n# Tools\n\nYou have access to the following functions:\n\n<tools>\n<function>\n<name>get_weather</name>\n<description>Get current weather</description>\n<parameters>\n<parameter>\n<name>location</name>\n<type>string</type>\n</parameter>\n<parameter>\n<name>unit</name>\n<type>string</type>\n<enum>[\"c\", \"f\"]</enum>\n</parameter>\n<required>[\"location\"]</required>\n</parameters>\n</function>\n<function>\n<name>search</name>\n<description>Search web</description>\n<parameters>\n<parameter>\n<name>query</name>\n<type>string</type>\n</parameter>\n<required>[\"query\"]</required>\n</parameters>\n</function>\n</tools>\n\nIf you choose to call a function ONLY reply in the following format with NO suffix:\n\n<tool_call>\n<function=example_function_name>\n<parameter=example_parameter_1>\nvalue_1\n</parameter>\n<parameter=example_parameter_2>\nThis is the value for the second parameter\nthat can span\nmultiple lines\n</parameter>\n</function>\n</tool_call>\n\n<IMPORTANT>\nReminder:\n- Function calls MUST follow the specified format: an inner <function=...></function> block must be nested within <tool_call></tool_call> XML tags\n- Required parameters MUST be specified\n- You may provide optional reasoning for your function call in natural language BEFORE the function call, but NOT after\n- If there is no function call available, answer the question like normal with your current knowledge and do not tell the user about function calls\n</IMPORTANT><|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "deepseek-ai/DeepSeek-R1-Distill-Qwen-7B": {
    "template": "{% if not add_generation_prompt is defined %}{% set add_generation_prompt = false %}{% endif %}{% set ns = namespace(is_first=false, is_tool=false, is_output_first=true, system_prompt='') %}{%- for message in messages %}{%- if message['role'] == 'system' %}{% set ns.system_prompt = message['content'] %}{%- endif %}{%- endfor %}{{bos_token}}{{ns.system_prompt}}{%- for message in messages %}{%- if message['role'] == 'user' %}{%- set ns.is_tool = false -%}{{'<User>' + message['content']}}{%- endif %}{%- if message['role'] == 'assistant' and message['content'] is none %}{%- set ns.is_tool = false -%}{%- for tool in message['tool_calls']%}{%- if not ns.is_first %}{{'<Assistant><toolcallsbegin><toolcallbegin>' + tool['type'] + '<toolsep>' + tool['function']['name'] + '\\n' + '```json' + '\\n' + tool['function']['arguments'] + '\\n' + '```' + '<toolcallend>'}}{%- set ns.is_first = true -%}{%- else %}{{'\\n' + '<toolcallbegin>' + tool['type'] + '<toolsep>' + tool['function']['name'] + '\\n' + '```json' + '\\n' + tool['function']['arguments'] + '\\n' + '```' + '<toolcallend>'}}{{'<toolcallsend><endofsentence>'}}{%- endif %}{%- endfor %}{%- endif %}{%- if message['role'] == 'assistant' and message['content'] is not none %}{%- if ns.is_tool %}{{'<tooloutputsend>' + message['content'] + '<endofsentence>'}}{%- set ns.is_tool = false -%}{%- else %}{% set content = message['content'] %}{% if '</think>' in content %}{% set content = content.split('</think>')[-1] %}{% endif %}{{'<Assistant>' + content + '<endofsentence>'}}{%- endif %}{%- endif %}{%- if message['role'] == 'tool' %}{%- set ns.is_tool = true -%}{%- if ns.is_output_first %}{{'<tooloutputsbegin><tooloutputbegin>' + message['content'] + '<tooloutputend>'}}{%- set ns.is_output_first = false %}{%- else %}{{'\\n<tooloutputbegin>' + message['content'] + '<tooloutputend>'}}{%- endif %}{%- endif %}{%- endfor -%}{% if ns.is_tool %}{{'<tooloutputsend>'}}{% endif %}{% if add_generation_prompt and not ns.is_tool %}{{'<Assistant><think>\\n'}}{% endif %}",
    "special_tokens": {
      "bos_token": "<beginofsentence>",
      "eos_token": "<endofsentence>",
      "unk_token": "",
      "pad_token": "<endofsentence>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<beginofsentence><User>Hi"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<beginofsentence>You are a helper.<User>Who are you?<Assistant>I am AI.<endofsentence>"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<beginofsentence><User>Part 1<User>Part 2"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<beginofsentence><User>Hello<Assistant><think>\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<beginofsentence><User>Hello"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<beginofsentence><User>Hello<Assistant><think>\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<beginofsentence><User>Hi<Assistant><think>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<beginofsentence><User>Weather in NY?<Assistant><endofsentence><tooloutputsbegin><tooloutputbegin>{\"temp\": 20}<tooloutputend><tooloutputsend>",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<beginofsentence><User>Solve<Assistant>42<endofsentence>"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<beginofsentence>Current Date: 2025-12-16<User>Date?"
      }
    ]
  },
  "deepseek-ai/DeepSeek-R1": {
    "template": "{% if not add_generation_prompt is defined %}{% set add_generation_prompt = false %}{% endif %}{% set ns = namespace(is_first=false, is_tool=false, is_output_first=true, system_prompt='', is_first_sp=true) %}{%- for message in messages %}{%- if message['role'] == 'system' %}{%- if ns.is_first_sp %}{% set ns.system_prompt = ns.system_prompt + message['content'] %}{% set ns.is_first_sp = false %}{%- else %}{% set ns.system_prompt = ns.system_prompt + '\\n\\n' + message['content'] %}{%- endif %}{%- endif %}{%- endfor %}{{ bos_token }}{{ ns.system_prompt }}{%- for message in messages %}{%- if message['role'] == 'user' %}{%- set ns.is_tool = false -%}{{'<User>' + message['content']}}{%- endif %}{%- if message['role'] == 'assistant' and 'tool_calls' in message %}{%- set ns.is_tool = false -%}{%- for tool in message['tool_calls'] %}{%- if not ns.is_first %}{%- if message['content'] is none %}{{'<Assistant><toolcallsbegin><toolcallbegin>' + tool['type'] + '<toolsep>' + tool['function']['name'] + '\\n' + '```json' + '\\n' + tool['function']['arguments'] + '\\n' + '```' + '<toolcallend>'}}{%- else %}{{'<Assistant>' + message['content'] + '<toolcallsbegin><toolcallbegin>' + tool['type'] + '<toolsep>' + tool['function']['name'] + '\\n' + '```json' + '\\n' + tool['function']['arguments'] + '\\n' + '```' + '<toolcallend>'}}{%- endif %}{%- set ns.is_first = true -%}{%- else %}{{'\\n' + '<toolcallbegin>' + tool['type'] + '<toolsep>' + tool['function']['name'] + '\\n' + '```json' + '\\n' + tool['function']['arguments'] + '\\n' + '```' + '<toolcallend>'}}{%- endif %}{%- endfor %}{{'<toolcallsend><endofsentence>'}}{%- endif %}{%- if message['role'] == 'assistant' and 'tool_calls' not in message %}{%- if ns.is_tool %}{{'<tooloutputsend>' + message['content'] + '<endofsentence>'}}{%- set ns.is_tool = false -%}{%- else %}{% set content = message['content'] %}{% if '</think>' in content %}{% set content = content.split('</think>')[-1] %}{% endif %}{{'<Assistant>' + content + '<endofsentence>'}}{%- endif %}{%- endif %}{%- if message['role'] == 'tool' %}{%- set ns.is_tool = true -%}{%- if ns.is_output_first %}{{'<tooloutputsbegin><tooloutputbegin>' + message['content'] + '<tooloutputend>'}}{%- set ns.is_output_first = false %}{%- else %}{{'<tooloutputbegin>' + message['content'] + '<tooloutputend>'}}{%- endif %}{%- endif %}{%- endfor -%}{% if ns.is_tool %}{{'<tooloutputsend>'}}{% endif %}{% if add_generation_prompt and not ns.is_tool %}{{'<Assistant><think>\\n'}}{% endif %}",
    "special_tokens": {
      "bos_token": "<beginofsentence>",
      "eos_token": "<endofsentence>",
      "unk_token": "",
      "pad_token": "<endofsentence>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<beginofsentence><User>Hi"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<beginofsentence>You are a helper.<User>Who are you?<Assistant>I am AI.<endofsentence>"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<beginofsentence><User>Part 1<User>Part 2"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<beginofsentence><User>Hello<Assistant><think>\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<beginofsentence><User>Hello"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<beginofsentence><User>Hello<Assistant><think>\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<beginofsentence><User>Hi<Assistant><think>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<beginofsentence><User>Weather in NY?<Assistant><toolcallsbegin><toolcallbegin>function<toolsep>get_weather\n```json\n{\"location\":\"NY\"}\n```<toolcallend><toolcallsend><endofsentence><tooloutputsbegin><tooloutputbegin>{\"temp\": 20}<tooloutputend><tooloutputsend>",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<beginofsentence><User>Solve<Assistant>42<endofsentence>"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<beginofsentence>Current Date: 2025-12-16<User>Date?"
      }
    ]
  },
  "ZhipuAI/GLM-4.5V": {
    "template": "[gMASK]<sop>\n{%- if tools -%}\n<|system|>\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{% for tool in tools %}\n{{ tool | tojson(ensure_ascii=False) }}\n{% endfor %}\n</tools>\n\nFor each function call, output the function name and arguments within the following XML format:\n<tool_call>{function-name}\n<arg_key>{arg-key-1}</arg_key>\n<arg_value>{arg-value-1}</arg_value>\n<arg_key>{arg-key-2}</arg_key>\n<arg_value>{arg-value-2}</arg_value>\n...\n</tool_call>{%- endif -%}\n{%- macro visible_text(content) -%}\n    {%- if content is string -%}\n        {{- content }}\n    {%- elif content is iterable and content is not mapping -%}\n        {%- for item in content -%}\n            {%- if item is mapping and item.type == 'text' -%}\n                {{- item.text }}\n            {%- elif item is mapping and (item.type == 'image' or 'image' in item) -%}\n                <|begin_of_image|><|image|><|end_of_image|>\n            {%- elif item is mapping and (item.type == 'video' or 'video' in item) -%}\n                <|begin_of_video|><|video|><|end_of_video|>\n            {%- elif item is string -%}\n                {{- item }}\n            {%- endif -%}\n        {%- endfor -%}\n    {%- else -%}\n        {{- content }}\n    {%- endif -%}\n{%- endmacro -%}\n{%- set ns = namespace(last_user_index=-1) %}\n{%- for m in messages %}\n    {%- if m.role == 'user' %}\n        {% set ns.last_user_index = loop.index0 -%}\n    {%- endif %}\n{%- endfor %}\n{% for m in messages %}\n{%- if m.role == 'user' -%}<|user|>\n{% if m.content is string %}\n{{ m.content }}\n{%- else %}\n{%- for item in m.content %}\n{% if item.type == 'video' or 'video' in item %}\n<|begin_of_video|><|video|><|end_of_video|>{% elif item.type == 'image' or 'image' in item %}\n<|begin_of_image|><|image|><|end_of_image|>{% elif item.type == 'text' %}\n{{ item.text }}\n{%- endif %}\n{%- endfor %}\n{%- endif %}\n{{- '/nothink' if (enable_thinking is defined and not enable_thinking and not visible_text(m.content).endswith(\"/nothink\")) else '' -}}\n{%- elif m.role == 'assistant' -%}\n<|assistant|>\n{%- set reasoning_content = '' %}\n{%- set content = visible_text(m.content) %}\n{%- if m.reasoning_content is string %}\n    {%- set reasoning_content = m.reasoning_content %}\n{%- else %}\n    {%- if '</think>' in content %}\n        {%- set reasoning_content = content.split('</think>')[0].rstrip('\\n').split('<think>')[-1].lstrip('\\n') %}\n        {%- set content = content.split('</think>')[-1].lstrip('\\n') %}\n    {%- endif %}\n{%- endif %}\n{%- if loop.index0 > ns.last_user_index and reasoning_content -%}\n{{ '\\n<think>' + reasoning_content.strip() +  '</think>'}}\n{%- else -%}\n{{ '\\n<think></think>' }}\n{%- endif -%}\n{%- if content.strip() -%}\n{{ '\\n' + content.strip() }}\n{%- endif -%}\n{% if m.tool_calls %}\n{% for tc in m.tool_calls %}\n{%- if tc.function %}\n    {%- set tc = tc.function %}\n{%- endif %}\n{{ '\\n<tool_call>' + tc.name }}\n{% set _args = tc.arguments %}\n{% for k, v in _args.items() %}\n<arg_key>{{ k }}</arg_key>\n<arg_value>{{ v | tojson(ensure_ascii=False) if v is not string else v }}</arg_value>\n{% endfor %}\n</tool_call>{% endfor %}\n{% endif %}\n{%- elif m.role == 'tool' -%}\n{%- if m.content is string -%}\n{%- if loop.first or (messages[loop.index0 - 1].role != \"tool\") %}\n    {{- '<|observation|>' }}\n{%- endif %}\n{{- '\\n<tool_response>\\n' }}\n{{- m.content }}\n{{- '\\n</tool_response>' }}\n{%- else -%}\n<|observation|>{% for tr in m.content %}\n\n<tool_response>\n{{ tr.output if tr.output is defined else tr }}\n</tool_response>{% endfor -%}\n{% endif -%}\n{%- elif m.role == 'system' -%}\n<|system|>\n{{ visible_text(m.content) }}\n{%- endif -%}\n{%- endfor -%}\n{%- if add_generation_prompt -%}\n<|assistant|>\n{{'<think></think>\\n' if (enable_thinking is defined and not enable_thinking) else ''}}\n{%- endif -%}",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|endoftext|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "[gMASK]<sop><|user|>\nHi"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "[gMASK]<sop><|system|>\nYou are a helper.<|user|>\nWho are you?<|assistant|>\n<think></think>\nI am AI."
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "[gMASK]<sop><|user|>\nPart 1<|user|>\nPart 2"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "[gMASK]<sop><|user|>\nHello<|assistant|>\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "[gMASK]<sop><|user|>\nHello"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "[gMASK]<sop><|user|>\nHello<|assistant|>\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "[gMASK]<sop><|system|>\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, output the function name and arguments within the following XML format:\n<tool_call>{function-name}\n<arg_key>{arg-key-1}</arg_key>\n<arg_value>{arg-value-1}</arg_value>\n<arg_key>{arg-key-2}</arg_key>\n<arg_value>{arg-value-2}</arg_value>\n...\n</tool_call><|user|>\nHi<|assistant|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "[gMASK]<sop><|user|>\nSolve<|assistant|>\n<think>Thinking process...</think>\n42"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "[gMASK]<sop><|system|>\nCurrent Date: 2025-12-16<|user|>\nDate?"
      }
    ]
  },
  "ZhipuAI/GLM-4.6V": {
    "template": "[gMASK]<sop>\n{%- if tools -%}\n<|system|>\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{% for tool in tools %}\n{{ tool | tojson(ensure_ascii=False) }}\n{% endfor %}\n</tools>\n\nFor each function call, output the function name and arguments within the following XML format:\n<tool_call>{function-name}\n<arg_key>{arg-key-1}</arg_key>\n<arg_value>{arg-value-1}</arg_value>\n<arg_key>{arg-key-2}</arg_key>\n<arg_value>{arg-value-2}</arg_value>\n...\n</tool_call>{%- endif -%}\n{%- macro visible_text(content) -%}\n    {%- if content is string -%}\n        {{- content }}\n    {%- elif content is iterable and content is not mapping -%}\n        {%- for item in content -%}\n            {%- if item is mapping and item.type == 'text' -%}\n                {{- item.text }}\n            {%- elif item is mapping and (item.type == 'image' or 'image' in item) -%}\n                <|begin_of_image|><|image|><|end_of_image|>\n            {%- elif item is mapping and (item.type == 'video' or 'video' in item) -%}\n                <|begin_of_video|><|video|><|end_of_video|>\n            {%- elif item is string -%}\n                {{- item }}\n            {%- endif -%}\n        {%- endfor -%}\n    {%- else -%}\n        {{- content }}\n    {%- endif -%}\n{%- endmacro -%}\n{%- set ns = namespace(last_user_index=-1) %}\n{%- for m in messages %}\n    {%- if m.role == 'user' %}\n        {% set ns.last_user_index = loop.index0 -%}\n    {%- endif %}\n{%- endfor %}\n{% for m in messages %}\n{%- if m.role == 'user' -%}<|user|>\n{% if m.content is string %}\n{{ m.content }}\n{%- else %}\n{%- for item in m.content %}\n{% if item.type == 'video' or 'video' in item %}\n<|begin_of_video|><|video|><|end_of_video|>{% elif item.type == 'image' or 'image' in item %}\n<|begin_of_image|><|image|><|end_of_image|>{% elif item.type == 'text' %}\n{{ item.text }}\n{%- endif %}\n{%- endfor %}\n{%- endif %}\n{{- '/nothink' if (enable_thinking is defined and not enable_thinking and not visible_text(m.content).endswith(\"/nothink\")) else '' -}}\n{%- elif m.role == 'assistant' -%}\n<|assistant|>\n{%- set reasoning_content = '' %}\n{%- set content = visible_text(m.content) %}\n{%- if m.reasoning_content is string %}\n    {%- set reasoning_content = m.reasoning_content %}\n{%- else %}\n    {%- if '</think>' in content %}\n        {%- set reasoning_content = content.split('</think>')[0].rstrip('\\n').split('<think>')[-1].lstrip('\\n') %}\n        {%- set content = content.split('</think>')[-1].lstrip('\\n') %}\n    {%- endif %}\n{%- endif %}\n{%- if loop.index0 > ns.last_user_index and reasoning_content -%}\n{{ '\\n<think>' + reasoning_content.strip() +  '</think>'}}\n{%- else -%}\n{{ '\\n<think></think>' }}\n{%- endif -%}\n{%- if content.strip() -%}\n{{ '\\n' + content.strip() }}\n{%- endif -%}\n{% if m.tool_calls %}\n{% for tc in m.tool_calls %}\n{%- if tc.function %}\n    {%- set tc = tc.function %}\n{%- endif %}\n{{ '\\n<tool_call>' + tc.name }}\n{% set _args = tc.arguments %}\n{% for k, v in _args.items() %}\n<arg_key>{{ k }}</arg_key>\n<arg_value>{{ v | tojson(ensure_ascii=False) if v is not string else v }}</arg_value>\n{% endfor %}\n</tool_call>{% endfor %}\n{% endif %}\n{%- elif m.role == 'tool' -%}\n{%- if m.content is string -%}\n{%- if loop.first or (messages[loop.index0 - 1].role != \"tool\") %}\n    {{- '<|observation|>' }}\n{%- endif %}\n{{- '\\n<tool_response>\\n' }}\n{{- m.content }}\n{{- '\\n</tool_response>' }}\n{% elif m.content is iterable and m.content is not mapping %}\n{%- if loop.first or (messages[loop.index0 - 1].role != \"tool\") %}\n{{- '<|observation|>' }}\n{%- endif %}\n{{- '\\n<tool_response>\\n' }}\n{%- for tr in m.content -%}\n  {%- if tr is mapping and tr.type is defined -%}\n    {%- set t = tr.type | lower -%}\n    {%- if t == 'text' and tr.text is defined -%}\n{{ tr.text }}\n    {%- elif t in ['image', 'image_url'] -%}\n<|begin_of_image|><|image|><|end_of_image|>\n    {%- elif t in ['video', 'video_url'] -%}\n<|begin_of_video|><|video|><|end_of_video|>\n    {%- else -%}\n{{ tr | tojson(ensure_ascii=False) }}\n    {%- endif -%}\n  {%- else -%}\n{{ tr.output if tr.output is defined else tr }}\n  {%- endif -%}\n{%- endfor -%}\n{{- '\\n</tool_response>' }}\n{%- else -%}\n<|observation|>{% for tr in m.content %}\n\n<tool_response>\n{{ tr.output if tr.output is defined else tr }}\n</tool_response>{% endfor -%}\n{% endif -%}\n{# ======  ====== #}\n{%- elif m.role == 'system' -%}\n<|system|>\n{{ visible_text(m.content) }}\n{%- endif -%}\n{%- endfor -%}\n{%- if add_generation_prompt -%}\n<|assistant|>\n{{'<think></think>\\n' if (enable_thinking is defined and not enable_thinking) else ''}}\n{%- endif -%}",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|endoftext|>",
      "unk_token": "",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "[gMASK]<sop><|user|>\nHi"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "[gMASK]<sop><|system|>\nYou are a helper.<|user|>\nWho are you?<|assistant|>\n<think></think>\nI am AI."
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "[gMASK]<sop><|user|>\nPart 1<|user|>\nPart 2"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "[gMASK]<sop><|user|>\nHello<|assistant|>\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "[gMASK]<sop><|user|>\nHello"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "[gMASK]<sop><|user|>\nHello<|assistant|>\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "[gMASK]<sop><|system|>\n# Tools\n\nYou may call one or more functions to assist with the user query.\n\nYou are provided with function signatures within <tools></tools> XML tags:\n<tools>\n{\"type\": \"function\", \"function\": {\"name\": \"get_weather\", \"description\": \"Get current weather\", \"parameters\": {\"type\": \"object\", \"properties\": {\"location\": {\"type\": \"string\"}, \"unit\": {\"type\": \"string\", \"enum\": [\"c\", \"f\"]}}, \"required\": [\"location\"]}}}\n{\"type\": \"function\", \"function\": {\"name\": \"search\", \"description\": \"Search web\", \"parameters\": {\"type\": \"object\", \"properties\": {\"query\": {\"type\": \"string\"}}, \"required\": [\"query\"]}}}\n</tools>\n\nFor each function call, output the function name and arguments within the following XML format:\n<tool_call>{function-name}\n<arg_key>{arg-key-1}</arg_key>\n<arg_value>{arg-value-1}</arg_value>\n<arg_key>{arg-key-2}</arg_key>\n<arg_value>{arg-value-2}</arg_value>\n...\n</tool_call><|user|>\nHi<|assistant|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "[gMASK]<sop><|user|>\nSolve<|assistant|>\n<think>Thinking process...</think>\n42"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "[gMASK]<sop><|system|>\nCurrent Date: 2025-12-16<|user|>\nDate?"
      }
    ]
  },
  "HuggingFaceTB/SmolLM-135M-Instruct": {
    "template": "{% for message in messages %}{{'<|im_start|>' + message['role'] + '\n' + message['content'] + '<|im_end|>' + '\n'}}{% endfor %}{% if add_generation_prompt %}{{ '<|im_start|>assistant\n' }}{% endif %}",
    "special_tokens": {
      "bos_token": "<|im_start|>",
      "eos_token": "<|im_end|>",
      "unk_token": "<|endoftext|>",
      "pad_token": "<|im_end|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<|im_end|>\n<|im_start|>tool\n{\"temp\": 20}<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "HuggingFaceTB/SmolVLM-256M-Instruct": {
    "template": "<|im_start|>{% for message in messages %}{{message['role'] | capitalize}}{% if message['content'][0]['type'] == 'image' %}{{':'}}{% else %}{{': '}}{% endif %}{% for line in message['content'] %}{% if line['type'] == 'text' %}{{line['text']}}{% elif line['type'] == 'image' %}{{ '<image>' }}{% endif %}{% endfor %}<end_of_utterance>\n{% endfor %}{% if add_generation_prompt %}{{ 'Assistant:' }}{% endif %}",
    "special_tokens": {
      "bos_token": "<|im_start|>",
      "eos_token": "<end_of_utterance>",
      "unk_token": "<|endoftext|>",
      "pad_token": "<|im_end|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>User: <end_of_utterance>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>System: <end_of_utterance>\nUser: <end_of_utterance>\nAssistant: <end_of_utterance>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>User: <end_of_utterance>\nUser: <end_of_utterance>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>User: <end_of_utterance>\nAssistant:"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>User: <end_of_utterance>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>User: <end_of_utterance>\nAssistant:"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>User: <end_of_utterance>\nAssistant:",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>User: <end_of_utterance>\nAssistant: <end_of_utterance>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>System: <end_of_utterance>\nUser: <end_of_utterance>\n"
      }
    ]
  },
  "HuggingFaceTB/SmolLM2-135M-Instruct": {
    "template": "{% for message in messages %}{% if loop.first and messages[0]['role'] != 'system' %}{{ '<|im_start|>system\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face<|im_end|>\n' }}{% endif %}{{'<|im_start|>' + message['role'] + '\n' + message['content'] + '<|im_end|>' + '\n'}}{% endfor %}{% if add_generation_prompt %}{{ '<|im_start|>assistant\n' }}{% endif %}",
    "special_tokens": {
      "bos_token": "<|im_start|>",
      "eos_token": "<|im_end|>",
      "unk_token": "<|endoftext|>",
      "pad_token": "<|im_end|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face<|im_end|>\n<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helper.<|im_end|>\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face<|im_end|>\n<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face<|im_end|>\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face<|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face<|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<|im_end|>\n<|im_start|>tool\n{\"temp\": 20}<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face<|im_end|>\n<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\nCurrent Date: 2025-12-16<|im_end|>\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "HuggingFaceTB/SmolLM3-3B": {
    "template": "{#  defaults  #}\n{%- if enable_thinking is not defined -%}\n{%- set enable_thinking = true -%}\n{%- endif -%}\n\n{#  reasoning mode  #}\n{%- if enable_thinking -%}\n  {%- set reasoning_mode = \"/think\" -%}\n{%- else -%}\n  {%- set reasoning_mode = \"/no_think\" -%}\n{%- endif -%}\n\n{#  header (system message)  #}\n{{- \"<|im_start|>system\\n\" -}}\n\n{%- if messages[0].role == \"system\" -%}\n  {%- set system_message = messages[0].content -%}\n  {%- if \"/no_think\" in system_message -%}\n    {%- set reasoning_mode = \"/no_think\" -%}\n  {%- elif \"/think\" in system_message -%}\n    {%- set reasoning_mode = \"/think\" -%}\n  {%- endif -%}\n  {%- set custom_instructions = system_message.replace(\"/no_think\", \"\").replace(\"/think\", \"\").rstrip() -%}\n{%- endif -%}\n\n{%- if \"/system_override\" in system_message -%}\n  {{- custom_instructions.replace(\"/system_override\", \"\").rstrip() -}}\n  {{- \"<|im_end|>\\n\" -}}\n{%- else -%}\n  {{- \"## Metadata\\n\\n\" -}}\n  {{- \"Knowledge Cutoff Date: June 2025\\n\" -}}\n  {%- set today = strftime_now(\"%d %B %Y\") -%}\n  {{- \"Today Date: \" ~ today ~ \"\\n\" -}}\n  {{- \"Reasoning Mode: \" + reasoning_mode + \"\\n\\n\" -}}\n  \n  {{- \"## Custom Instructions\\n\\n\" -}}\n  {%- if custom_instructions -%}\n    {{- custom_instructions + \"\\n\\n\" -}}\n  {%- elif reasoning_mode == \"/think\" -%}\n    {{- \"You are a helpful AI assistant named SmolLM, trained by Hugging Face. Your role as an assistant involves thoroughly exploring questions through a systematic thinking process before providing the final precise and accurate solutions. This requires engaging in a comprehensive cycle of analysis, summarizing, exploration, reassessment, reflection, backtracking, and iteration to develop well-considered thinking process. Please structure your response into two main sections: Thought and Solution using the specified format: <think> Thought section </think> Solution section. In the Thought section, detail your reasoning process in steps. Each step should include detailed considerations such as analysing questions, summarizing relevant findings, brainstorming new ideas, verifying the accuracy of the current steps, refining any errors, and revisiting previous steps. In the Solution section, based on various attempts, explorations, and reflections from the Thought section, systematically present the final solution that you deem correct. The Solution section should be logical, accurate, and concise and detail necessary steps needed to reach the conclusion.\\n\\n\" -}}\n  {%- else -%}\n    {{- \"You are a helpful AI assistant named SmolLM, trained by Hugging Face.\\n\\n\" -}}\n  {%- endif -%}\n\n  {%- if xml_tools or python_tools or tools -%}\n    {{- \"### Tools\\n\\n\" -}}\n    {%- if xml_tools or tools -%}\n      {%- if tools -%}\n        {%- set xml_tools = tools -%}\n      {%- endif -%}\n      {%- set ns = namespace(xml_tool_string=\"You may call one or more functions to assist with the user query.\\nYou are provided with function signatures within <tools></tools> XML tags:\\n\\n<tools>\\n\") -%}\n      {%- for tool in xml_tools[:] -%} {# The slicing makes sure that xml_tools is a list #}\n        {%- set ns.xml_tool_string = ns.xml_tool_string ~ (tool | string) ~ \"\\n\" -%}\n      {%- endfor -%}\n      {%- set xml_tool_string = ns.xml_tool_string + \"</tools>\\n\\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\\n<tool_call>\\n{\\\"name\\\": <function-name>, \\\"arguments\\\": <args-json-object>}\\n</tool_call>\" -%}\n      {{- xml_tool_string -}}\n    {%- endif -%}\n    {%- if python_tools -%}\n      {%- set ns = namespace(python_tool_string=\"When you send a message containing Python code between '<code>' and '</code>' tags, it will be executed in a stateful Jupyter notebook environment, and you will then be given the output to continued reasoning in an agentic loop.\\n\\nYou can use the following tools in your python code like regular functions:\\n<tools>\\n\") -%}\n      {%- for tool in python_tools[:] -%} {# The slicing makes sure that python_tools is a list #}\n        {%- set ns.python_tool_string = ns.python_tool_string ~ (tool | string) ~ \"\\n\" -%}\n      {%- endfor -%}\n      {%- set python_tool_string = ns.python_tool_string + \"</tools>\\n\\nThe state persists between code executions: so variables that you define in one step are still available thereafter.\" -%}\n      {{- python_tool_string -}}\n    {%- endif -%}\n    {{- \"\\n\\n\" -}}\n    {{- \"<|im_end|>\\n\" -}}\n  {%- endif -%}\n{%- endif -%}\n{#  main loop  #}\n{%- for message in messages -%}\n    {%- set content = message.content if message.content is string else \"\" -%}\n    {%- if message.role == \"user\" -%}\n        {{ \"<|im_start|>\" + message.role + \"\\n\"  + content + \"<|im_end|>\\n\" }}\n    {%- elif message.role == \"assistant\" -%}\n        {% generation %}\n        {%- if reasoning_mode == \"/think\" -%}\n            {{ \"<|im_start|>assistant\\n\" + content.lstrip(\"\\n\") + \"<|im_end|>\\n\" }}\n        {%- else -%}\n            {{ \"<|im_start|>assistant\\n\" + \"<think>\\n\\n</think>\\n\" + content.lstrip(\"\\n\") + \"<|im_end|>\\n\" }}\n        {%- endif -%}\n        {% endgeneration %}\n    {%- elif message.role == \"tool\" -%}\n    {{ \"<|im_start|>\" + \"user\\n\"  + content + \"<|im_end|>\\n\" }}\n    {%- endif -%}\n{%- endfor -%}\n{#  generation prompt  #}\n{%- if add_generation_prompt -%}\n    {%- if reasoning_mode == \"/think\" -%}\n        {{ \"<|im_start|>assistant\\n\" }}\n    {%- else -%}\n        {{ \"<|im_start|>assistant\\n\" + \"<think>\\n\\n</think>\\n\"  }}\n    {%- endif -%}\n{%- endif -%}",
    "special_tokens": {
      "bos_token": "",
      "eos_token": "<|im_end|>",
      "unk_token": "",
      "pad_token": "<|im_end|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n## Metadata\n\nKnowledge Cutoff Date: June 2025\nToday Date: 16 December 2025\nReasoning Mode: /think\n\n## Custom Instructions\n\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face. Your role as an assistant involves thoroughly exploring questions through a systematic thinking process before providing the final precise and accurate solutions. This requires engaging in a comprehensive cycle of analysis, summarizing, exploration, reassessment, reflection, backtracking, and iteration to develop well-considered thinking process. Please structure your response into two main sections: Thought and Solution using the specified format: <think> Thought section </think> Solution section. In the Thought section, detail your reasoning process in steps. Each step should include detailed considerations such as analysing questions, summarizing relevant findings, brainstorming new ideas, verifying the accuracy of the current steps, refining any errors, and revisiting previous steps. In the Solution section, based on various attempts, explorations, and reflections from the Thought section, systematically present the final solution that you deem correct. The Solution section should be logical, accurate, and concise and detail necessary steps needed to reach the conclusion.\n\n<|im_start|>user\nHi<|im_end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n## Metadata\n\nKnowledge Cutoff Date: June 2025\nToday Date: 16 December 2025\nReasoning Mode: /think\n\n## Custom Instructions\n\nYou are a helper.\n\n<|im_start|>user\nWho are you?<|im_end|>\n<|im_start|>assistant\nI am AI.<|im_end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n## Metadata\n\nKnowledge Cutoff Date: June 2025\nToday Date: 16 December 2025\nReasoning Mode: /think\n\n## Custom Instructions\n\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face. Your role as an assistant involves thoroughly exploring questions through a systematic thinking process before providing the final precise and accurate solutions. This requires engaging in a comprehensive cycle of analysis, summarizing, exploration, reassessment, reflection, backtracking, and iteration to develop well-considered thinking process. Please structure your response into two main sections: Thought and Solution using the specified format: <think> Thought section </think> Solution section. In the Thought section, detail your reasoning process in steps. Each step should include detailed considerations such as analysing questions, summarizing relevant findings, brainstorming new ideas, verifying the accuracy of the current steps, refining any errors, and revisiting previous steps. In the Solution section, based on various attempts, explorations, and reflections from the Thought section, systematically present the final solution that you deem correct. The Solution section should be logical, accurate, and concise and detail necessary steps needed to reach the conclusion.\n\n<|im_start|>user\nPart 1<|im_end|>\n<|im_start|>user\nPart 2<|im_end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n## Metadata\n\nKnowledge Cutoff Date: June 2025\nToday Date: 16 December 2025\nReasoning Mode: /think\n\n## Custom Instructions\n\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face. Your role as an assistant involves thoroughly exploring questions through a systematic thinking process before providing the final precise and accurate solutions. This requires engaging in a comprehensive cycle of analysis, summarizing, exploration, reassessment, reflection, backtracking, and iteration to develop well-considered thinking process. Please structure your response into two main sections: Thought and Solution using the specified format: <think> Thought section </think> Solution section. In the Thought section, detail your reasoning process in steps. Each step should include detailed considerations such as analysing questions, summarizing relevant findings, brainstorming new ideas, verifying the accuracy of the current steps, refining any errors, and revisiting previous steps. In the Solution section, based on various attempts, explorations, and reflections from the Thought section, systematically present the final solution that you deem correct. The Solution section should be logical, accurate, and concise and detail necessary steps needed to reach the conclusion.\n\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n## Metadata\n\nKnowledge Cutoff Date: June 2025\nToday Date: 16 December 2025\nReasoning Mode: /think\n\n## Custom Instructions\n\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face. Your role as an assistant involves thoroughly exploring questions through a systematic thinking process before providing the final precise and accurate solutions. This requires engaging in a comprehensive cycle of analysis, summarizing, exploration, reassessment, reflection, backtracking, and iteration to develop well-considered thinking process. Please structure your response into two main sections: Thought and Solution using the specified format: <think> Thought section </think> Solution section. In the Thought section, detail your reasoning process in steps. Each step should include detailed considerations such as analysing questions, summarizing relevant findings, brainstorming new ideas, verifying the accuracy of the current steps, refining any errors, and revisiting previous steps. In the Solution section, based on various attempts, explorations, and reflections from the Thought section, systematically present the final solution that you deem correct. The Solution section should be logical, accurate, and concise and detail necessary steps needed to reach the conclusion.\n\n<|im_start|>user\nHello<|im_end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n## Metadata\n\nKnowledge Cutoff Date: June 2025\nToday Date: 16 December 2025\nReasoning Mode: /think\n\n## Custom Instructions\n\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face. Your role as an assistant involves thoroughly exploring questions through a systematic thinking process before providing the final precise and accurate solutions. This requires engaging in a comprehensive cycle of analysis, summarizing, exploration, reassessment, reflection, backtracking, and iteration to develop well-considered thinking process. Please structure your response into two main sections: Thought and Solution using the specified format: <think> Thought section </think> Solution section. In the Thought section, detail your reasoning process in steps. Each step should include detailed considerations such as analysing questions, summarizing relevant findings, brainstorming new ideas, verifying the accuracy of the current steps, refining any errors, and revisiting previous steps. In the Solution section, based on various attempts, explorations, and reflections from the Thought section, systematically present the final solution that you deem correct. The Solution section should be logical, accurate, and concise and detail necessary steps needed to reach the conclusion.\n\n<|im_start|>user\nHello<|im_end|>\n<|im_start|>assistant\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n## Metadata\n\nKnowledge Cutoff Date: June 2025\nToday Date: 16 December 2025\nReasoning Mode: /think\n\n## Custom Instructions\n\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face. Your role as an assistant involves thoroughly exploring questions through a systematic thinking process before providing the final precise and accurate solutions. This requires engaging in a comprehensive cycle of analysis, summarizing, exploration, reassessment, reflection, backtracking, and iteration to develop well-considered thinking process. Please structure your response into two main sections: Thought and Solution using the specified format: <think> Thought section </think> Solution section. In the Thought section, detail your reasoning process in steps. Each step should include detailed considerations such as analysing questions, summarizing relevant findings, brainstorming new ideas, verifying the accuracy of the current steps, refining any errors, and revisiting previous steps. In the Solution section, based on various attempts, explorations, and reflections from the Thought section, systematically present the final solution that you deem correct. The Solution section should be logical, accurate, and concise and detail necessary steps needed to reach the conclusion.\n\n### Tools\n\nYou may call one or more functions to assist with the user query.\nYou are provided with function signatures within <tools></tools> XML tags:\n\n<tools>\n{'type': 'function', 'function': {'name': 'get_weather', 'description': 'Get current weather', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string'}, 'unit': {'type': 'string', 'enum': ['c', 'f']}}, 'required': ['location']}}}\n{'type': 'function', 'function': {'name': 'search', 'description': 'Search web', 'parameters': {'type': 'object', 'properties': {'query': {'type': 'string'}}, 'required': ['query']}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call>\n\n<|im_end|>\n<|im_start|>user\nHi<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n## Metadata\n\nKnowledge Cutoff Date: June 2025\nToday Date: 16 December 2025\nReasoning Mode: /think\n\n## Custom Instructions\n\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face. Your role as an assistant involves thoroughly exploring questions through a systematic thinking process before providing the final precise and accurate solutions. This requires engaging in a comprehensive cycle of analysis, summarizing, exploration, reassessment, reflection, backtracking, and iteration to develop well-considered thinking process. Please structure your response into two main sections: Thought and Solution using the specified format: <think> Thought section </think> Solution section. In the Thought section, detail your reasoning process in steps. Each step should include detailed considerations such as analysing questions, summarizing relevant findings, brainstorming new ideas, verifying the accuracy of the current steps, refining any errors, and revisiting previous steps. In the Solution section, based on various attempts, explorations, and reflections from the Thought section, systematically present the final solution that you deem correct. The Solution section should be logical, accurate, and concise and detail necessary steps needed to reach the conclusion.\n\n### Tools\n\nYou may call one or more functions to assist with the user query.\nYou are provided with function signatures within <tools></tools> XML tags:\n\n<tools>\n{'type': 'function', 'function': {'name': 'get_weather', 'description': 'Get current weather', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string'}, 'unit': {'type': 'string', 'enum': ['c', 'f']}}, 'required': ['location']}}}\n{'type': 'function', 'function': {'name': 'search', 'description': 'Search web', 'parameters': {'type': 'object', 'properties': {'query': {'type': 'string'}}, 'required': ['query']}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call>\n\n<|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<|im_end|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n## Metadata\n\nKnowledge Cutoff Date: June 2025\nToday Date: 16 December 2025\nReasoning Mode: /think\n\n## Custom Instructions\n\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face. Your role as an assistant involves thoroughly exploring questions through a systematic thinking process before providing the final precise and accurate solutions. This requires engaging in a comprehensive cycle of analysis, summarizing, exploration, reassessment, reflection, backtracking, and iteration to develop well-considered thinking process. Please structure your response into two main sections: Thought and Solution using the specified format: <think> Thought section </think> Solution section. In the Thought section, detail your reasoning process in steps. Each step should include detailed considerations such as analysing questions, summarizing relevant findings, brainstorming new ideas, verifying the accuracy of the current steps, refining any errors, and revisiting previous steps. In the Solution section, based on various attempts, explorations, and reflections from the Thought section, systematically present the final solution that you deem correct. The Solution section should be logical, accurate, and concise and detail necessary steps needed to reach the conclusion.\n\n### Tools\n\nYou may call one or more functions to assist with the user query.\nYou are provided with function signatures within <tools></tools> XML tags:\n\n<tools>\n{'type': 'function', 'function': {'name': 'get_weather', 'description': 'Get current weather', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string'}, 'unit': {'type': 'string', 'enum': ['c', 'f']}}, 'required': ['location']}}}\n{'type': 'function', 'function': {'name': 'search', 'description': 'Search web', 'parameters': {'type': 'object', 'properties': {'query': {'type': 'string'}}, 'required': ['query']}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call>\n\n<|im_end|>\n<|im_start|>user\nWeather in NY?<|im_end|>\n<|im_start|>assistant\n<|im_end|>\n<|im_start|>user\n{\"temp\": 20}<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "parallel_tool_calls",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY and SF?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_1",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              },
              {
                "id": "call_2",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"SF\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_1",
            "name": "get_weather",
            "content": "20C"
          },
          {
            "role": "tool",
            "tool_call_id": "call_2",
            "name": "get_weather",
            "content": "15C"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>system\n## Metadata\n\nKnowledge Cutoff Date: June 2025\nToday Date: 16 December 2025\nReasoning Mode: /think\n\n## Custom Instructions\n\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face. Your role as an assistant involves thoroughly exploring questions through a systematic thinking process before providing the final precise and accurate solutions. This requires engaging in a comprehensive cycle of analysis, summarizing, exploration, reassessment, reflection, backtracking, and iteration to develop well-considered thinking process. Please structure your response into two main sections: Thought and Solution using the specified format: <think> Thought section </think> Solution section. In the Thought section, detail your reasoning process in steps. Each step should include detailed considerations such as analysing questions, summarizing relevant findings, brainstorming new ideas, verifying the accuracy of the current steps, refining any errors, and revisiting previous steps. In the Solution section, based on various attempts, explorations, and reflections from the Thought section, systematically present the final solution that you deem correct. The Solution section should be logical, accurate, and concise and detail necessary steps needed to reach the conclusion.\n\n### Tools\n\nYou may call one or more functions to assist with the user query.\nYou are provided with function signatures within <tools></tools> XML tags:\n\n<tools>\n{'type': 'function', 'function': {'name': 'get_weather', 'description': 'Get current weather', 'parameters': {'type': 'object', 'properties': {'location': {'type': 'string'}, 'unit': {'type': 'string', 'enum': ['c', 'f']}}, 'required': ['location']}}}\n{'type': 'function', 'function': {'name': 'search', 'description': 'Search web', 'parameters': {'type': 'object', 'properties': {'query': {'type': 'string'}}, 'required': ['query']}}}\n</tools>\n\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\n<tool_call>\n{\"name\": <function-name>, \"arguments\": <args-json-object>}\n</tool_call>\n\n<|im_end|>\n<|im_start|>user\nWeather in NY and SF?<|im_end|>\n<|im_start|>assistant\n<|im_end|>\n<|im_start|>user\n20C<|im_end|>\n<|im_start|>user\n15C<|im_end|>\n<|im_start|>assistant\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n## Metadata\n\nKnowledge Cutoff Date: June 2025\nToday Date: 16 December 2025\nReasoning Mode: /think\n\n## Custom Instructions\n\nYou are a helpful AI assistant named SmolLM, trained by Hugging Face. Your role as an assistant involves thoroughly exploring questions through a systematic thinking process before providing the final precise and accurate solutions. This requires engaging in a comprehensive cycle of analysis, summarizing, exploration, reassessment, reflection, backtracking, and iteration to develop well-considered thinking process. Please structure your response into two main sections: Thought and Solution using the specified format: <think> Thought section </think> Solution section. In the Thought section, detail your reasoning process in steps. Each step should include detailed considerations such as analysing questions, summarizing relevant findings, brainstorming new ideas, verifying the accuracy of the current steps, refining any errors, and revisiting previous steps. In the Solution section, based on various attempts, explorations, and reflections from the Thought section, systematically present the final solution that you deem correct. The Solution section should be logical, accurate, and concise and detail necessary steps needed to reach the conclusion.\n\n<|im_start|>user\nSolve<|im_end|>\n<|im_start|>assistant\n42<|im_end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system\n## Metadata\n\nKnowledge Cutoff Date: June 2025\nToday Date: 16 December 2025\nReasoning Mode: /think\n\n## Custom Instructions\n\nCurrent Date: 2025-12-16\n\n<|im_start|>user\nDate?<|im_end|>\n"
      }
    ]
  },
  "google/gemma-3-4b-it": {
    "template": "{{ bos_token }}\n{%- if messages[0]['role'] == 'system' -%}\n    {%- if messages[0]['content'] is string -%}\n        {%- set first_user_prefix = messages[0]['content'] + '\n\n' -%}\n    {%- else -%}\n        {%- set first_user_prefix = messages[0]['content'][0]['text'] + '\n\n' -%}\n    {%- endif -%}\n    {%- set loop_messages = messages[1:] -%}\n{%- else -%}\n    {%- set first_user_prefix = \"\" -%}\n    {%- set loop_messages = messages -%}\n{%- endif -%}\n{%- for message in loop_messages -%}\n    {%- if (message['role'] == 'user') != (loop.index0 % 2 == 0) -%}\n        {{ raise_exception(\"Conversation roles must alternate user/assistant/user/assistant/...\") }}\n    {%- endif -%}\n    {%- if (message['role'] == 'assistant') -%}\n        {%- set role = \"model\" -%}\n    {%- else -%}\n        {%- set role = message['role'] -%}\n    {%- endif -%}\n    {{ '<start_of_turn>' + role + '\n' + (first_user_prefix if loop.first else \"\") }}\n    {%- if message['content'] is string -%}\n        {{ message['content'] | trim }}\n    {%- elif message['content'] is iterable -%}\n        {%- for item in message['content'] -%}\n            {%- if item['type'] == 'image' -%}\n                {{ '<start_of_image>' }}\n            {%- elif item['type'] == 'text' -%}\n                {{ item['text'] | trim }}\n            {%- endif -%}\n        {%- endfor -%}\n    {%- else -%}\n        {{ raise_exception(\"Invalid content type\") }}\n    {%- endif -%}\n    {{ '<end_of_turn>\n' }}\n{%- endfor -%}\n{%- if add_generation_prompt -%}\n    {{'<start_of_turn>model\n'}}\n{%- endif -%}\n",
    "special_tokens": {
      "bos_token": "<bos>",
      "eos_token": "<eos>",
      "unk_token": "<unk>",
      "pad_token": "<pad>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<bos><start_of_turn>user\nHi<end_of_turn>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<bos><start_of_turn>user\nYou are a helper.\n\nWho are you?<end_of_turn>\n<start_of_turn>model\nI am AI.<end_of_turn>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<bos><start_of_turn>user\nHello<end_of_turn>\n<start_of_turn>model\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<bos><start_of_turn>user\nHello<end_of_turn>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<bos><start_of_turn>user\nHello<end_of_turn>\n<start_of_turn>model\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<bos><start_of_turn>user\nHi<end_of_turn>\n<start_of_turn>model\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<bos><start_of_turn>user\nWeather in NY?<end_of_turn>\n<start_of_turn>model\n<end_of_turn>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<bos><start_of_turn>user\nSolve<end_of_turn>\n<start_of_turn>model\n42<end_of_turn>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<bos><start_of_turn>user\nCurrent Date: 2025-12-16\n\nDate?<end_of_turn>\n"
      }
    ]
  },
  "google/gemma-3n-E4B-it": {
    "template": "{{ bos_token }}\n{%- if messages[0]['role'] == 'system' -%}\n    {%- if messages[0]['content'] is string -%}\n        {%- set first_user_prefix = messages[0]['content'] + '\n\n' -%}\n    {%- else -%}\n        {%- set first_user_prefix = messages[0]['content'][0]['text'] + '\n\n' -%}\n    {%- endif -%}\n    {%- set loop_messages = messages[1:] -%}\n{%- else -%}\n    {%- set first_user_prefix = \"\" -%}\n    {%- set loop_messages = messages -%}\n{%- endif -%}\n{%- for message in loop_messages -%}\n    {%- if (message['role'] == 'user') != (loop.index0 % 2 == 0) -%}\n        {{ raise_exception(\"Conversation roles must alternate user/assistant/user/assistant/...\") }}\n    {%- endif -%}\n    {%- if (message['role'] == 'assistant') -%}\n        {%- set role = \"model\" -%}\n    {%- else -%}\n        {%- set role = message['role'] -%}\n    {%- endif -%}\n    {{ '<start_of_turn>' + role + '\n' + (first_user_prefix if loop.first else \"\") }}\n    {%- if message['content'] is string -%}\n        {{ message['content'] | trim }}\n    {%- elif message['content'] is iterable -%}\n        {%- for item in message['content'] -%}\n            {%- if item['type'] == 'audio' -%}\n                {{ '<audio_soft_token>' }}\n            {%- elif item['type'] == 'image' -%}\n                {{ '<image_soft_token>' }}\n            {%- elif item['type'] == 'text' -%}\n                {{ item['text'] | trim }}\n            {%- endif -%}\n        {%- endfor -%}\n    {%- else -%}\n        {{ raise_exception(\"Invalid content type\") }}\n    {%- endif -%}\n    {{ '<end_of_turn>\n' }}\n{%- endfor -%}\n{%- if add_generation_prompt -%}\n    {{'<start_of_turn>model\n'}}\n{%- endif -%}\n",
    "special_tokens": {
      "bos_token": "<bos>",
      "eos_token": "<eos>",
      "unk_token": "<unk>",
      "pad_token": "<pad>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<bos><start_of_turn>user\nHi<end_of_turn>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<bos><start_of_turn>user\nYou are a helper.\n\nWho are you?<end_of_turn>\n<start_of_turn>model\nI am AI.<end_of_turn>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<bos><start_of_turn>user\nHello<end_of_turn>\n<start_of_turn>model\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<bos><start_of_turn>user\nHello<end_of_turn>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<bos><start_of_turn>user\nHello<end_of_turn>\n<start_of_turn>model\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<bos><start_of_turn>user\nHi<end_of_turn>\n<start_of_turn>model\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<bos><start_of_turn>user\nWeather in NY?<end_of_turn>\n<start_of_turn>model\n<end_of_turn>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<bos><start_of_turn>user\nSolve<end_of_turn>\n<start_of_turn>model\n42<end_of_turn>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<bos><start_of_turn>user\nCurrent Date: 2025-12-16\n\nDate?<end_of_turn>\n"
      }
    ]
  },
  "LLM-Research/Meta-Llama-3-8B-Instruct": {
    "template": "{% set loop_messages = messages %}{% for message in loop_messages %}{% set content = '<|start_header_id|>' + message['role'] + '<|end_header_id|>\n\n'+ message['content'] | trim + '<|eot_id|>' %}{% if loop.index0 == 0 %}{% set content = bos_token + content %}{% endif %}{{ content }}{% endfor %}{% if add_generation_prompt %}{{ '<|start_header_id|>assistant<|end_header_id|>\n\n' }}{% endif %}",
    "special_tokens": {
      "bos_token": "<|begin_of_text|>",
      "eos_token": "<|eot_id|>",
      "unk_token": "",
      "pad_token": ""
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>user<|end_header_id|>\n\nHi<|eot_id|>"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nYou are a helper.<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nWho are you?<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\nI am AI.<|eot_id|>"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>user<|end_header_id|>\n\nPart 1<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nPart 2<|eot_id|>"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|begin_of_text|><|start_header_id|>user<|end_header_id|>\n\nHello<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>user<|end_header_id|>\n\nHello<|eot_id|>"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|begin_of_text|><|start_header_id|>user<|end_header_id|>\n\nHello<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|begin_of_text|><|start_header_id|>user<|end_header_id|>\n\nHi<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>user<|end_header_id|>\n\nWeather in NY?<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n<|eot_id|>",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|begin_of_text|><|start_header_id|>user<|end_header_id|>\n\nWeather in NY?<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n<|eot_id|><|start_header_id|>tool<|end_header_id|>\n\n{\"temp\": 20}<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "parallel_tool_calls",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY and SF?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_1",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              },
              {
                "id": "call_2",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"SF\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_1",
            "name": "get_weather",
            "content": "20C"
          },
          {
            "role": "tool",
            "tool_call_id": "call_2",
            "name": "get_weather",
            "content": "15C"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|begin_of_text|><|start_header_id|>user<|end_header_id|>\n\nWeather in NY and SF?<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n<|eot_id|><|start_header_id|>tool<|end_header_id|>\n\n20C<|eot_id|><|start_header_id|>tool<|end_header_id|>\n\n15C<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>user<|end_header_id|>\n\nSolve<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n42<|eot_id|>"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCurrent Date: 2025-12-16<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nDate?<|eot_id|>"
      }
    ]
  },
  "LLM-Research/Llama-3.2-3B-Instruct": {
    "template": "{{- bos_token }}\n{%- if custom_tools is defined %}\n    {%- set tools = custom_tools %}\n{%- endif %}\n{%- if not tools_in_user_message is defined %}\n    {%- set tools_in_user_message = true %}\n{%- endif %}\n{%- if not date_string is defined %}\n    {%- if strftime_now is defined %}\n        {%- set date_string = strftime_now(\"%d %b %Y\") %}\n    {%- else %}\n        {%- set date_string = \"26 Jul 2024\" %}\n    {%- endif %}\n{%- endif %}\n{%- if not tools is defined %}\n    {%- set tools = none %}\n{%- endif %}\n\n{#- This block extracts the system message, so we can slot it into the right place. #}\n{%- if messages[0]['role'] == 'system' %}\n    {%- set system_message = messages[0]['content']|trim %}\n    {%- set messages = messages[1:] %}\n{%- else %}\n    {%- set system_message = \"\" %}\n{%- endif %}\n\n{#- System message #}\n{{- \"<|start_header_id|>system<|end_header_id|>\\n\\n\" }}\n{%- if tools is not none %}\n    {{- \"Environment: ipython\\n\" }}\n{%- endif %}\n{{- \"Cutting Knowledge Date: December 2023\\n\" }}\n{{- \"Today Date: \" + date_string + \"\\n\\n\" }}\n{%- if tools is not none and not tools_in_user_message %}\n    {{- \"You have access to the following functions. To call a function, please respond with JSON for a function call.\" }}\n    {{- 'Respond in the format {\"name\": function name, \"parameters\": dictionary of argument name and its value}.' }}\n    {{- \"Do not use variables.\\n\\n\" }}\n    {%- for t in tools %}\n        {{- t | tojson(indent=4) }}\n        {{- \"\\n\\n\" }}\n    {%- endfor %}\n{%- endif %}\n{{- system_message }}\n{{- \"<|eot_id|>\" }}\n\n{#- Custom tools are passed in a user message with some extra guidance #}\n{%- if tools_in_user_message and not tools is none %}\n    {#- Extract the first user message so we can plug it in here #}\n    {%- if messages | length != 0 %}\n        {%- set first_user_message = messages[0]['content']|trim %}\n        {%- set messages = messages[1:] %}\n    {%- else %}\n        {{- raise_exception(\"Cannot put tools in the first user message when there's no first user message!\") }}\n{%- endif %}\n    {{- '<|start_header_id|>user<|end_header_id|>\\n\\n' -}}\n    {{- \"Given the following functions, please respond with a JSON for a function call \" }}\n    {{- \"with its proper arguments that best answers the given prompt.\\n\\n\" }}\n    {{- 'Respond in the format {\"name\": function name, \"parameters\": dictionary of argument name and its value}.' }}\n    {{- \"Do not use variables.\\n\\n\" }}\n    {%- for t in tools %}\n        {{- t | tojson(indent=4) }}\n        {{- \"\\n\\n\" }}\n    {%- endfor %}\n    {{- first_user_message + \"<|eot_id|>\"}}\n{%- endif %}\n\n{%- for message in messages %}\n    {%- if not (message.role == 'ipython' or message.role == 'tool' or 'tool_calls' in message) %}\n        {{- '<|start_header_id|>' + message['role'] + '<|end_header_id|>\\n\\n'+ message['content'] | trim + '<|eot_id|>' }}\n    {%- elif 'tool_calls' in message %}\n        {%- if not message.tool_calls|length == 1 %}\n            {{- raise_exception(\"This model only supports single tool-calls at once!\") }}\n        {%- endif %}\n        {%- set tool_call = message.tool_calls[0].function %}\n        {{- '<|start_header_id|>assistant<|end_header_id|>\\n\\n' -}}\n        {{- '{\"name\": \"' + tool_call.name + '\", ' }}\n        {{- '\"parameters\": ' }}\n        {{- tool_call.arguments | tojson }}\n        {{- \"}\" }}\n        {{- \"<|eot_id|>\" }}\n    {%- elif message.role == \"tool\" or message.role == \"ipython\" %}\n        {{- \"<|start_header_id|>ipython<|end_header_id|>\\n\\n\" }}\n        {%- if message.content is mapping or message.content is iterable %}\n            {{- message.content | tojson }}\n        {%- else %}\n            {{- message.content }}\n        {%- endif %}\n        {{- \"<|eot_id|>\" }}\n    {%- endif %}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|start_header_id|>assistant<|end_header_id|>\\n\\n' }}\n{%- endif %}\n",
    "special_tokens": {
      "bos_token": "<|begin_of_text|>",
      "eos_token": "<|eot_id|>",
      "unk_token": "",
      "pad_token": ""
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 16 Dec 2025\n\n<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nHi<|eot_id|>"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 16 Dec 2025\n\nYou are a helper.<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nWho are you?<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\nI am AI.<|eot_id|>"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 16 Dec 2025\n\n<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nPart 1<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nPart 2<|eot_id|>"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 16 Dec 2025\n\n<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nHello<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 16 Dec 2025\n\n<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nHello<|eot_id|>"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 16 Dec 2025\n\n<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nHello<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nEnvironment: ipython\nCutting Knowledge Date: December 2023\nToday Date: 16 Dec 2025\n\n<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nGiven the following functions, please respond with a JSON for a function call with its proper arguments that best answers the given prompt.\n\nRespond in the format {\"name\": function name, \"parameters\": dictionary of argument name and its value}.Do not use variables.\n\n{\n    \"type\": \"function\",\n    \"function\": {\n        \"name\": \"get_weather\",\n        \"description\": \"Get current weather\",\n        \"parameters\": {\n            \"type\": \"object\",\n            \"properties\": {\n                \"location\": {\n                    \"type\": \"string\"\n                },\n                \"unit\": {\n                    \"type\": \"string\",\n                    \"enum\": [\n                        \"c\",\n                        \"f\"\n                    ]\n                }\n            },\n            \"required\": [\n                \"location\"\n            ]\n        }\n    }\n}\n\n{\n    \"type\": \"function\",\n    \"function\": {\n        \"name\": \"search\",\n        \"description\": \"Search web\",\n        \"parameters\": {\n            \"type\": \"object\",\n            \"properties\": {\n                \"query\": {\n                    \"type\": \"string\"\n                }\n            },\n            \"required\": [\n                \"query\"\n            ]\n        }\n    }\n}\n\nHi<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "assistant_tool_call_history",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nEnvironment: ipython\nCutting Knowledge Date: December 2023\nToday Date: 16 Dec 2025\n\n<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nGiven the following functions, please respond with a JSON for a function call with its proper arguments that best answers the given prompt.\n\nRespond in the format {\"name\": function name, \"parameters\": dictionary of argument name and its value}.Do not use variables.\n\n{\n    \"type\": \"function\",\n    \"function\": {\n        \"name\": \"get_weather\",\n        \"description\": \"Get current weather\",\n        \"parameters\": {\n            \"type\": \"object\",\n            \"properties\": {\n                \"location\": {\n                    \"type\": \"string\"\n                },\n                \"unit\": {\n                    \"type\": \"string\",\n                    \"enum\": [\n                        \"c\",\n                        \"f\"\n                    ]\n                }\n            },\n            \"required\": [\n                \"location\"\n            ]\n        }\n    }\n}\n\n{\n    \"type\": \"function\",\n    \"function\": {\n        \"name\": \"search\",\n        \"description\": \"Search web\",\n        \"parameters\": {\n            \"type\": \"object\",\n            \"properties\": {\n                \"query\": {\n                    \"type\": \"string\"\n                }\n            },\n            \"required\": [\n                \"query\"\n            ]\n        }\n    }\n}\n\nWeather in NY?<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n{\"name\": \"get_weather\", \"parameters\": \"{\\\"location\\\":\\\"NY\\\"}\"}<|eot_id|>",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nEnvironment: ipython\nCutting Knowledge Date: December 2023\nToday Date: 16 Dec 2025\n\n<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nGiven the following functions, please respond with a JSON for a function call with its proper arguments that best answers the given prompt.\n\nRespond in the format {\"name\": function name, \"parameters\": dictionary of argument name and its value}.Do not use variables.\n\n{\n    \"type\": \"function\",\n    \"function\": {\n        \"name\": \"get_weather\",\n        \"description\": \"Get current weather\",\n        \"parameters\": {\n            \"type\": \"object\",\n            \"properties\": {\n                \"location\": {\n                    \"type\": \"string\"\n                },\n                \"unit\": {\n                    \"type\": \"string\",\n                    \"enum\": [\n                        \"c\",\n                        \"f\"\n                    ]\n                }\n            },\n            \"required\": [\n                \"location\"\n            ]\n        }\n    }\n}\n\n{\n    \"type\": \"function\",\n    \"function\": {\n        \"name\": \"search\",\n        \"description\": \"Search web\",\n        \"parameters\": {\n            \"type\": \"object\",\n            \"properties\": {\n                \"query\": {\n                    \"type\": \"string\"\n                }\n            },\n            \"required\": [\n                \"query\"\n            ]\n        }\n    }\n}\n\nWeather in NY?<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n{\"name\": \"get_weather\", \"parameters\": \"{\\\"location\\\":\\\"NY\\\"}\"}<|eot_id|><|start_header_id|>ipython<|end_header_id|>\n\n\"{\\\"temp\\\": 20}\"<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 16 Dec 2025\n\n<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nSolve<|eot_id|><|start_header_id|>assistant<|end_header_id|>\n\n42<|eot_id|>"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|begin_of_text|><|start_header_id|>system<|end_header_id|>\n\nCutting Knowledge Date: December 2023\nToday Date: 16 Dec 2025\n\nCurrent Date: 2025-12-16<|eot_id|><|start_header_id|>user<|end_header_id|>\n\nDate?<|eot_id|>"
      }
    ]
  },
  "LLM-Research/Phi-3.5-mini-instruct": {
    "template": "{% for message in messages %}{% if message['role'] == 'system' and message['content'] %}{{'<|system|>\n' + message['content'] + '<|end|>\n'}}{% elif message['role'] == 'user' %}{{'<|user|>\n' + message['content'] + '<|end|>\n'}}{% elif message['role'] == 'assistant' %}{{'<|assistant|>\n' + message['content'] + '<|end|>\n'}}{% endif %}{% endfor %}{% if add_generation_prompt %}{{ '<|assistant|>\n' }}{% else %}{{ eos_token }}{% endif %}",
    "special_tokens": {
      "bos_token": "<s>",
      "eos_token": "<|endoftext|>",
      "unk_token": "<unk>",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|user|>\nHi<|end|>\n<|endoftext|>"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|system|>\nYou are a helper.<|end|>\n<|user|>\nWho are you?<|end|>\n<|assistant|>\nI am AI.<|end|>\n<|endoftext|>"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|user|>\nPart 1<|end|>\n<|user|>\nPart 2<|end|>\n<|endoftext|>"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|user|>\nHello<|end|>\n<|assistant|>\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|user|>\nHello<|end|>\n<|endoftext|>"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|user|>\nHello<|end|>\n<|assistant|>\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|user|>\nHi<|end|>\n<|assistant|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|user|>\nWeather in NY?<|end|>\n<|assistant|>\n<|end|>\n<|assistant|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|user|>\nSolve<|end|>\n<|assistant|>\n42<|end|>\n<|endoftext|>"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|system|>\nCurrent Date: 2025-12-16<|end|>\n<|user|>\nDate?<|end|>\n<|endoftext|>"
      }
    ]
  },
  "LLM-Research/Phi-3.5-vision-instruct": {
    "template": "{% for message in messages %}{{'<|' + message['role'] + '|>' + '\n' + message['content'] + '<|end|>\n' }}{% endfor %}{% if add_generation_prompt and messages[-1]['role'] != 'assistant' %}{{- '<|assistant|>\n' -}}{% endif %}",
    "special_tokens": {
      "bos_token": "<s>",
      "eos_token": "<|endoftext|>",
      "unk_token": "<unk>",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|user|>\nHi<|end|>\n"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|system|>\nYou are a helper.<|end|>\n<|user|>\nWho are you?<|end|>\n<|assistant|>\nI am AI.<|end|>\n"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|user|>\nPart 1<|end|>\n<|user|>\nPart 2<|end|>\n"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|user|>\nHello<|end|>\n<|assistant|>\n"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|user|>\nHello<|end|>\n"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|user|>\nHello<|end|>\n<|assistant|>\n"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|user|>\nHi<|end|>\n<|assistant|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|user|>\nWeather in NY?<|end|>\n<|assistant|>\n<|end|>\n<|tool|>\n{\"temp\": 20}<|end|>\n<|assistant|>\n",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|user|>\nSolve<|end|>\n<|assistant|>\n42<|end|>\n"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|system|>\nCurrent Date: 2025-12-16<|end|>\n<|user|>\nDate?<|end|>\n"
      }
    ]
  },
  "LLM-Research/phi-4": {
    "template": "{% for message in messages %}{% if (message['role'] == 'system') %}{{'<|im_start|>system<|im_sep|>' + message['content'] + '<|im_end|>'}}{% elif (message['role'] == 'user') %}{{'<|im_start|>user<|im_sep|>' + message['content'] + '<|im_end|>'}}{% elif (message['role'] == 'assistant') %}{{'<|im_start|>assistant<|im_sep|>' + message['content'] + '<|im_end|>'}}{% endif %}{% endfor %}{% if add_generation_prompt %}{{ '<|im_start|>assistant<|im_sep|>' }}{% endif %}",
    "special_tokens": {
      "bos_token": "<|endoftext|>",
      "eos_token": "<|im_end|>",
      "unk_token": "<|endoftext|>",
      "pad_token": "<|dummy_85|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user<|im_sep|>Hi<|im_end|>"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system<|im_sep|>You are a helper.<|im_end|><|im_start|>user<|im_sep|>Who are you?<|im_end|><|im_start|>assistant<|im_sep|>I am AI.<|im_end|>"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user<|im_sep|>Part 1<|im_end|><|im_start|>user<|im_sep|>Part 2<|im_end|>"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user<|im_sep|>Hello<|im_end|><|im_start|>assistant<|im_sep|>"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user<|im_sep|>Hello<|im_end|>"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user<|im_sep|>Hello<|im_end|><|im_start|>assistant<|im_sep|>"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user<|im_sep|>Hi<|im_end|><|im_start|>assistant<|im_sep|>",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|im_start|>user<|im_sep|>Weather in NY?<|im_end|><|im_start|>assistant<|im_sep|><|im_end|><|im_start|>assistant<|im_sep|>",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>user<|im_sep|>Solve<|im_end|><|im_start|>assistant<|im_sep|>42<|im_end|>"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|im_start|>system<|im_sep|>Current Date: 2025-12-16<|im_end|><|im_start|>user<|im_sep|>Date?<|im_end|>"
      }
    ]
  },
  "LLM-Research/Phi-4-mini-reasoning": {
    "template": "{{ '<|system|>Your name is Phi, an AI math expert developed by Microsoft.' }}{% for message in messages %}{% if message['role'] == 'system' %} {{ message['content'] }}{% if 'tools' in message and message['tools'] is not none %}{{ '<|tool|>' + message['tools'] + '<|/tool|>' }}{% endif %}{% endif %}{% endfor %}{{ '<|end|>' }}{% for message in messages %}{% if message['role'] != 'system' %}{{ '<|' + message['role'] + '|>' + message['content'] + '<|end|>' }}{% endif %}{% endfor %}{% if add_generation_prompt %}{{ '<|assistant|>' }}{% else %}{{ eos_token }}{% endif %}",
    "special_tokens": {
      "bos_token": "<|endoftext|>",
      "eos_token": "<|endoftext|>",
      "unk_token": "<|endoftext|>",
      "pad_token": "<|endoftext|>"
    },
    "cases": [
      {
        "description": "basic_user",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|system|>Your name is Phi, an AI math expert developed by Microsoft.<|end|><|user|>Hi<|end|><|endoftext|>"
      },
      {
        "description": "system_user_assistant",
        "messages": [
          {
            "role": "system",
            "content": "You are a helper."
          },
          {
            "role": "user",
            "content": "Who are you?"
          },
          {
            "role": "assistant",
            "content": "I am AI."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|system|>Your name is Phi, an AI math expert developed by Microsoft. You are a helper.<|end|><|user|>Who are you?<|end|><|assistant|>I am AI.<|end|><|endoftext|>"
      },
      {
        "description": "consecutive_users",
        "messages": [
          {
            "role": "user",
            "content": "Part 1"
          },
          {
            "role": "user",
            "content": "Part 2"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|system|>Your name is Phi, an AI math expert developed by Microsoft.<|end|><|user|>Part 1<|end|><|user|>Part 2<|end|><|endoftext|>"
      },
      {
        "description": "gen_prompt_true",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|system|>Your name is Phi, an AI math expert developed by Microsoft.<|end|><|user|>Hello<|end|><|assistant|>"
      },
      {
        "description": "gen_prompt_false",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|system|>Your name is Phi, an AI math expert developed by Microsoft.<|end|><|user|>Hello<|end|><|endoftext|>"
      },
      {
        "description": "disable_thinking",
        "messages": [
          {
            "role": "user",
            "content": "Hello"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|system|>Your name is Phi, an AI math expert developed by Microsoft.<|end|><|user|>Hello<|end|><|assistant|>"
      },
      {
        "description": "tools_provided_no_call",
        "messages": [
          {
            "role": "user",
            "content": "Hi"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|system|>Your name is Phi, an AI math expert developed by Microsoft.<|end|><|user|>Hi<|end|><|assistant|>",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "tool_response_execution",
        "messages": [
          {
            "role": "user",
            "content": "Weather in NY?"
          },
          {
            "role": "assistant",
            "content": "",
            "tool_calls": [
              {
                "id": "call_123",
                "type": "function",
                "function": {
                  "name": "get_weather",
                  "arguments": "{\"location\":\"NY\"}"
                }
              }
            ]
          },
          {
            "role": "tool",
            "tool_call_id": "call_123",
            "name": "get_weather",
            "content": "{\"temp\": 20}"
          }
        ],
        "add_generation_prompt": true,
        "expected": "<|system|>Your name is Phi, an AI math expert developed by Microsoft.<|end|><|user|>Weather in NY?<|end|><|assistant|><|end|><|tool|>{\"temp\": 20}<|end|><|assistant|>",
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get current weather",
              "parameters": {
                "type": "object",
                "properties": {
                  "location": {
                    "type": "string"
                  },
                  "unit": {
                    "type": "string",
                    "enum": [
                      "c",
                      "f"
                    ]
                  }
                },
                "required": [
                  "location"
                ]
              }
            }
          },
          {
            "type": "function",
            "function": {
              "name": "search",
              "description": "Search web",
              "parameters": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  }
                },
                "required": [
                  "query"
                ]
              }
            }
          }
        ]
      },
      {
        "description": "reasoning_content",
        "messages": [
          {
            "role": "user",
            "content": "Solve"
          },
          {
            "role": "assistant",
            "content": "42",
            "reasoning_content": "Thinking process..."
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|system|>Your name is Phi, an AI math expert developed by Microsoft.<|end|><|user|>Solve<|end|><|assistant|>42<|end|><|endoftext|>"
      },
      {
        "description": "date_injection_sim",
        "messages": [
          {
            "role": "system",
            "content": "Current Date: 2025-12-16"
          },
          {
            "role": "user",
            "content": "Date?"
          }
        ],
        "add_generation_prompt": false,
        "expected": "<|system|>Your name is Phi, an AI math expert developed by Microsoft. Current Date: 2025-12-16<|end|><|user|>Date?<|end|><|endoftext|>"
      }
    ]
  }
}